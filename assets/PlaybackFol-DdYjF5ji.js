import{u as bt}from"./theme-BQuUkOYy.js";import{_ as jt}from"./MainWrapperView.vue_vue_type_style_index_0_lang-CxO8IUeu.js";import{_ as De}from"./SelectView.vue_vue_type_style_index_0_lang-DHU539oR.js";import{_ as ve}from"./InputView.vue_vue_type_style_index_0_lang-COD6yyZU.js";import{_ as $}from"./ButtonView.vue_vue_type_style_index_0_computed_true_lang-CPqDxasm.js";import{t as it,_ as It,m as Ut,L as qt,a as Bt,u as Kt}from"./LoadingView-IyALh3CR.js";import{d as et,g as u,B as Wt,h as rt,L as Ze,c as i,a as n,b as J,k as M,r as qe,w,o,m as gt,j as R,F as Y,e as t,l as p,n as ee,u as f,v as Ie,K as Ue,t as y,f as B,y as K,_ as ut,M as Ht,p as Gt}from"./index-BEW-jFoX.js";import{a as Xe}from"./index-Br0q4W-C.js";import{i as Qt}from"./index-2tC-Kj2m.js";import{h as O}from"./moment-C5S46NFB.js";const Jt={style:{width:"100%",display:"flex","flex-flow":"column"}},Xt=et({__name:"PressureDistView",props:{selectedSpot:{type:String,required:!0},data:{type:Object,required:!0},leakPointResult:Object},setup(Se){const te=u(!1),_=Se,A=Wt(()=>_.data),j=u(it().getAllTrunk()),m=u({}),F=u(_.selectedSpot),L=()=>j.value[F.value].trunkLength,g=u(0),T=P=>{g.value=P};return rt(()=>{te.value=!0,m.value=A.value,te.value=!1}),Ze(()=>{te.value=!0,m.value=A.value,te.value=!1}),(P,D)=>{const le=qe("center");return o(),i("div",Jt,[n(le,null,{default:w(()=>[n(ve,{"in-label":"Drop Tolerance Value","in-type":"number","model-value":g.value,"onUpdate:modelValue":D[0]||(D[0]=d=>g.value=d),style:{width:"200px"}},null,8,["model-value"])]),_:1}),!te.value&&Object.keys(m.value).length?(o(),J(It,{key:0,onOnToleranceChanged:T,"chart-data":m.value,"selected-spot":F.value,"trunk-length":L(),"tolerance-value":g.value,"prediction-result":_.leakPointResult},null,8,["chart-data","selected-spot","trunk-length","tolerance-value","prediction-result"])):M("",!0)])}}}),Zt={key:0,class:"datepickdialog"},el={class:"datepickinner"},tl={style:{display:"flex","flex-flow":"row nowrap",gap:"0.2rem"}},ll={key:1,class:"selfnavdialog"},al={class:"selfnavdialog-inner"},ol={style:{display:"flex","flex-flow":"row nowrap","justify-content":"center","margin-bottom":"1rem",gap:"1rem"}},sl={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem","justify-content":"space-between"}},nl={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},il={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem",height:"45px","align-items":"center"}},rl={style:{"border-radius":"10px",display:"flex","flex-flow":"row nowrap","justify-content":"space-between","padding-left":"10px","padding-right":"10px",border:"1px solid #ccc",padding:"20px","margin-bottom":"1rem"}},ul={style:{border:"1px solid #ccc",padding:"5px","padding-left":"70px","text-align":"center","padding-right":"70px","border-radius":"100px"}},dl={key:0,style:{"font-size":"11px"}},pl={key:0,style:{"font-size":"11px"}},vl={key:1,style:{"font-size":"11px"}},cl={style:{display:"flex","flex-flow":"row nowrap",width:"100%","align-items":"center","margin-top":"-40px"}},fl={style:{display:"flex","flex-flow":"no wrap",padding:"10px",gap:"0.5rem"}},yl={style:{width:"100%",padding:"10px",position:"relative"}},ml=["max","value"],bl={key:0,class:"sel-wrapper"},gl={style:{display:"flex","justify-content":"flex-start","overflow-x":"auto","white-space":"nowrap",padding:"20px",gap:"1rem",width:"40%"}},kl=["onClick"],hl={key:0,class:"dataspan"},wl={style:{width:"50%"}},xl={style:{color:"#fff",background:"red",width:"70px",padding:"5px","border-radius":"5px","font-size":"10px","text-align":"center"}},Dl={style:{width:"60%","padding-right":"5rem","padding-top":"1rem","padding-bottom":"1rem"}},Sl=["src"],Ml={class:"table-responsive"},Cl={style:{"margin-top":"1rem"}},$l={class:"tbl2"},Pl={style:{"margin-top":"1rem"}},Ol={class:"tbl2"},_l={key:0,style:{color:"red","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Yl={key:1,style:{color:"orange","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Ll={key:2,style:{color:"yellow","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Tl={key:3,style:{color:"lime","text-shadow":"0.5px 0.5px 1px rgba(0,0,0,0.6)"}},Vl={key:4},El={key:2,class:"hmloader"},Al={key:3,class:"model-window"},Fl={class:"modelpick-inner"},zl={key:4,class:"predict-action"},Nl={style:{"margin-bottom":"0.1rem"}},Rl={style:{"margin-bottom":"0.5rem"}},jl={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem"}},Il={key:5,class:"leak-window"},Ul={style:{color:"rgb(0,150,255)"}},ql={class:"table-responsive"},Bl={style:{width:"100%","margin-top":"1rem"},class:"table table-striped table-hover;"},Kl={key:0,style:{border:"1px solid #ccc",padding:"10px"}},Wl={key:1,style:{border:"1px solid #ccc",padding:"10px"}},Hl={style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Gl={key:0,style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Ql={key:1,style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Jl={key:0},Xl=["href"],Zl={style:{"margin-top":"1rem"}},ea={key:1},ta={style:{"margin-top":"1rem"}},la={class:"leak-footer"},aa={style:{display:"flex","flex-flow":"row nowrap","justify-content":"space-between"}},oa={key:6,class:"setting-window"},sa={class:"setting-inner"},na={class:"pref-block"},ia={key:7,class:"save-window"},ra={class:"save-inner"},ua={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem"}},da={key:8,class:"chart-option-window"},pa={class:"chart-option-inner"},va={type:"button",class:"chart-option-dismiss"},ca=et({__name:"PlaybackView",props:{initDateFilter:{type:String,required:!0},selectedSpot:{type:String,required:!0},initPlaybackDatas:{type:Array,required:!0},snapShots:{type:Object,required:!1,default:null},mainSize:{type:Object,required:!1}},emits:["onDateChange","onDataSave","onLoadPreset"],setup(Se,{emit:te}){const _=Kt(),A=it(),j=te,m=bt(),F=u("forward"),L=u(!1),g=u(""),T=u(!0),P=u(!1),D=Se,le=u(),d=u(),ne=u(A.getAllTrunk()),V=u(0),Ye=u(0),me=u([]),Me=u(!1),ae=u(250);let W=null;const Ce=u(!1);let ie=[];const $e={},tt=u(),re=u(""),Pe=u(""),X=u(!0),H=u(!1),x=u(!1),be=u(!1),ge=u(!1),ce=u(!1),Q=u(7),lt=gt();u(lt.params.saveid);let I=u({}),ke=null;const he=u(null),Le=u({}),at=()=>{d.value=Qt(le.value);const a={grid:{top:"10%",left:"10%",right:"10%",bottom:"15%"},legend:{show:!0,type:"scroll",orient:"horizontal"},tooltip:{trigger:"item",triggerOn:"mousemove",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},axisPointer:{show:!0,type:"shadow"},xAxis:[{type:"category",data:[],boundaryGap:!1,splitNumber:1,minInterval:1,scale:!0,axisLabel:{formatter:function(e){return e.split(" (")[1].split(")")[0]},rotate:45,labelStyle:{fontSize:10}},splitLine:{show:!0,lineStyle:{type:"dashed"}},axisTick:{alignWithLabel:!0}}],yAxis:{type:"value",name:"Pressure (PSI)",nameGap:10,max:600,interval:50,axisTick:{show:!0,inside:!0},splitLine:{show:!0,lineStyle:{type:"solid",color:"#999"}},minorTick:{show:!0},minorSplitLine:{show:!0,lineStyle:{type:"dashed",color:"#ccc"}}},series:[]};d.value.setOption(a),setTimeout(()=>{d.value.dispatchAction({type:"legendInverseSelect"}),d.value.dispatchAction({type:"legendAllSelect"}),d.value.resize()},100)},b=()=>{const a=O().format("YYYY-MM-DD"),e=O(D.initDateFilter).format("YYYY-MM-DD");Ce.value=a===e};rt(()=>{window.addEventListener("keyup",wt),b()}),R(()=>le.value,()=>{at(),r(V.value)}),R(()=>D.initPlaybackDatas,(a,e)=>{!a||a.length===0||(b(),c(),r(V.value),Me.value=!1,H.value&&(x.value=!0))});const r=a=>{ie=[];for(let l of ne.value[D.selectedSpot].spot)$e[l.name]=[];D.initPlaybackDatas.slice(0,a+1).forEach((l,v)=>{const h=`${l.dateFilter} (${l.timeRange})`;ie.push(h),tt.value=h,l.data.forEach(q=>{const Ge=ne.value[D.selectedSpot].spot.find(Je=>Je.id===q.idSpot).name,Qe=q.avgPsiValues??0;$e[Ge][v]=Number(Qe.toFixed(2))})});const s=Object.keys($e).map(l=>({name:l,type:"line",data:$e[l],showAllSymbol:ce.value,smooth:!1,tooltip:{trigger:"axis",formatter:function(v){return v[0].value}},endLabel:{show:!0,formatter:function(v){return v.value+" ; "+l},color:"#000",backgroundColor:"inherit",padding:5,fontSize:10,borderRadius:5}}));let k=d.value.getOption();k.xAxis[0].data=ie,k.series=s,d.value.setOption(k)},C=()=>{d.value.getOption()},c=()=>{x.value=!1,V.value=0,me.value=[],clearInterval(W),r(V.value),Ye.value=V.value/D.initPlaybackDatas.length*100},E=a=>{x.value=!1,me.value=[],V.value=parseInt(a.target.value,10),r(V.value),Ye.value=V.value/D.initPlaybackDatas.length*100};R(()=>D.initDateFilter,async()=>{st(),ot(),await Te().then(()=>{z()})});const z=()=>{const a=O(D.initDateFilter),e=a.add(1,"days").format("YYYY-MM-DD"),s=a.subtract(2,"days").format("YYYY-MM-DD");re.value=e,Pe.value=s};z();const N=async()=>{st(),await Te().then(()=>{if(Ce.value)m.notifyShowError("End of playback");else{be.value=!0,c();const a=O(re.value).format("YYYY-MM-DD");H.value&&(x.value=!0),Me.value=!0,j("onDateChange",a),setTimeout(()=>{be.value=!1},5e3)}})},Z=async()=>{st(),await Te().then(()=>{be.value=!0,c();const a=O(Pe.value).format("YYYY-MM-DD");H.value&&(x.value=!0),Me.value=!0,j("onDateChange",a),setTimeout(()=>{be.value=!1},5e3)})};R(()=>X.value,()=>{X.value&&(Ee(),L.value=!1,H.value=!1)}),R(()=>L.value,()=>{L.value?(X.value=!1,H.value=!0):X.value=!0}),R(()=>H.value,()=>{H.value&&(X.value=!1)}),R(()=>x.value,()=>{if(!x.value&&V.value==D.initPlaybackDatas.length)if(X.value)c(),x.value=!0;else{const a=O().format("YYYY-MM-DD"),e=O(D.initDateFilter).format("YYYY-MM-DD");a===e?x.value=!1:L.value?F.value=="forward"?ue.value?D.initDateFilter!=de.value?N():Be.value?(c(),j("onDateChange",pe.value)):Ee():N():ue.value?D.initDateFilter!=pe.value?Z():Be.value?(c(),j("onDateChange",de.value)):Ee():Z():(c(),x.value=!0)}G.value&&U.value?(dt(),fe(),C()):we()});const fe=()=>{if(x.value)we();else{const a=d.value.getOption();a.series.forEach(s=>{s.symbolSize=Q.value}),a.series.forEach(s=>{s.symbol="circle"});const e=d.value.getOption().tooltip;e.show=!0,d.value.setOption(a)}},we=()=>{const a=d.value.getOption();a.series.forEach(e=>{e.symbolSize=0}),a.series.forEach(e=>{e.symbol="none"}),d.value.setOption(a),d.value.off("click")},S=u({}),dt=()=>{d.value.off("click"),d.value.on("click",a=>{if(a.componentType==="markLine"){if(a.seriesName==="Normal"){m.notifyConfirm("Delete Normal","Are you sure?","Delete","Cancel",async()=>{pt()},()=>{});return}else m.notifyConfirm("Delete Marker","Delete this marker?","Delete","Cancel",async()=>{const v=d.value.getOption();v.series=v.series.filter((h,q)=>q!==a.seriesIndex),d.value.clear(),d.value.setOption(v),Object.keys(S.value).forEach(h=>{S.value[h].index===a.value&&delete S.value[h]}),T.value=!1,setTimeout(()=>{T.value=!0},100)},()=>{});return}const e=ie.findIndex(v=>v===a.name);if(e<0)return;if(S.value.normal){const v=Object.keys(S.value).length,h={type:"line",name:`Drop ${v}`,xAxisIndex:0,data:[],markLine:{symbol:"image://https://gpng.net/wp-content/uploads/ROBBER.png",symbolSize:35,data:[{xAxis:e,symbolRotate:180}],lineStyle:{color:"blue",width:2,type:"dotted"},label:{show:!0,formatter:`Drop ${v}`,position:"insideEndTop"}}},q=d.value.getOption().series;q.push(h),d.value.setOption({series:q})}else{const v={type:"line",name:"Normal",xAxisIndex:0,data:[],markLine:{symbol:"image://https://png.pngtree.com/png-clipart/20230325/original/pngtree-petroleum-workers-or-miners-vector-png-image_9004441.png",symbolSize:42,data:[{xAxis:e}],lineStyle:{color:"red",width:2,type:"dotted"},label:{show:!0,formatter:"Normal",position:"insideEndTop"}}},h=d.value.getOption().series;h.push(v),d.value.setOption({series:h})}const l=d.value.getOption().series.filter(v=>Array.isArray(v.data)).map(v=>({seriesName:v.name,yValue:v.data[e]??0}));if(S.value.normal){const v=Object.keys(S.value).length;S.value[`drop${v}`]={index:e,name:`Drop ${v}`,data:l,order:d.value.getOption().series.length-1,type:"drop",timerange:ie[e].split(" (")[1].split(")")[0],seriesName:ie[e].split(" (")[1].split(")")[0]+".drop."+D.initDateFilter,date:D.initDateFilter}}else{const v={normal:{index:e,name:"Normal",data:l,order:0,type:"normal",timerange:ie[e].split(" (")[1].split(")")[0],seriesName:ie[e].split(" (")[1].split(")")[0]+".normal."+D.initDateFilter,date:D.initDateFilter}};S.value={...v,...S.value},he.value=v.normal.seriesName}})},pt=()=>{const a=d.value.getOption();a.series=a.series.filter(e=>e.name!=="Normal"),d.value.clear(),d.value.setOption(a),delete S.value.normal,m.notifyShow("Normal deleted"),he.value=null},Te=()=>new Promise((a,e)=>{try{if(Object.keys(S.value).length===0){a();return}const s=d.value.getOption();s.series=s.series.filter(k=>!k.markLine),d.value.clear(),d.value.setOption(s),S.value={},a()}catch(s){e(s)}});R(()=>[x.value,ae.value],()=>{x.value?(W!=null&&clearInterval(W),W=setInterval(()=>{V.value<D.initPlaybackDatas.length?(V.value++,D.initPlaybackDatas[V.value]!=null&&(r(V.value),Ye.value=V.value/D.initPlaybackDatas.length*100)):(x.value=!1,clearInterval(W))},ae.value)):W&&(clearInterval(W),W=null)}),R(()=>[m.asideVisible],()=>{setTimeout(()=>{d.value.resize()},1e3)});const Ve=u(!1),kt=()=>F.value=="forward"?re.value:Pe.value,ye=u(!1),ue=u(!1),Be=u(!0),pe=u(""),de=u(""),ht=()=>{pe.value?de.value?(ue.value=!0,X.value=!1,L.value=!0,H.value=!0,ye.value=!1,x.value=!1):m.notifyShowError("Date 2 is required"):m.notifyShowError("Date 1 is required")};R(()=>ye.value,()=>{ye.value?(x.value=!1,ue.value=!1):x.value=!0}),R(()=>[ue.value],()=>{ue.value&&(c(),F.value=="forward"?j("onDateChange",pe.value):j("onDateChange",de.value))}),R(()=>F.value,()=>{F.value=="backward"&&(c(),Ee())});const Ee=()=>{c(),j("onDateChange",D.initDateFilter),ue.value=!1,pe.value=null,de.value=null},wt=a=>{P.value||((a.keyCode==80||a.keyCode==32)&&(x.value=!x.value),a.keyCode==37&&Z(),a.keyCode==39&&N())},xt=(a,e)=>{if(a.type=="normal"){m.notifyConfirm("Delete Normal","Are you sure?","Delete","Cancel",async()=>{pt()},()=>{});return}const s=d.value.getOption();s.series=s.series.filter(k=>k.name!==a.name),d.value.clear(),d.value.setOption(s),delete S.value[e],T.value=!1,setTimeout(()=>{T.value=!0},100)},G=u(null),U=u(null),oe=u(!1),Ae=u(!1),Dt=()=>{Ae.value?(oe.value=!1,Ae.value=!1):(G.value=null,U.value=null,oe.value=!1)};R(()=>oe.value,()=>{Ae.value=!1});const ot=()=>{G.value=null,U.value=null,oe.value=!1,we(),m.notifyShow("Prediction stopped"),Te(),S.value={}};R(()=>[G.value,U.value],()=>{G.value&&U.value?(dt(),fe()):we()});const St=()=>{Ae.value=!0,oe.value=!0},Fe=u(!1),vt=u([]),se=u([]),Oe=u(!1),Ke=u(),Mt=u(),Ct=()=>{if(!G.value||!U.value){m.notifyShowError("Please select model and method");return}m.notifyShow("Prediction started"),oe.value=!1;let a={};Object.keys(S.value).forEach(s=>{if(S.value[s].type!=="normal"||S.value[s].type!=="drop"){const k=A.getAllTrunk().trunk1.spot.length;let l={name:S.value[s].name,data:S.value[s].data.map(v=>({avgPsiValues:v.yValue})).slice(0,k),type:S.value[s].type};a[S.value[s].name]=l}}),vt.value=[];const e=_.mlpredict(a,U.value);if(Fe.value=!0,U.value==="dtree_multi"?setTimeout(()=>{se.value=e.sort((s,k)=>s.drop-k.drop)},4e3):U.value==="rf_multi"?setTimeout(()=>{se.value=e.sort((s,k)=>s.drop-k.drop)},4e3):U.value==="rf_single"?setTimeout(()=>{se.value=e.sort((s,k)=>s.drop-k.drop)},4e3):U.value==="eqlr_single"&&setTimeout(()=>{se.value=e.sort((s,k)=>s.drop-k.drop)},4e3),se.value!=null)for(let s=0;s<se.value.length;s++)se.value[s].suspectLocation.leak&&vt.value.push(se.value[s])},ct=u(),ft=u(),$t=(a,e,s)=>{Ke.value=a,Oe.value=!1,Oe.value=!0,ct.value=e,ft.value=s};R(()=>Fe.value,()=>{Fe.value||(Oe.value=!1,se.value=null,Ke.value=null,Mt.value=null)});const Pt=async a=>{g.value=a,await navigator.clipboard.writeText(g.value),m.notifyShow("Coordinate copied to clipboard")},We=a=>{const e=Math.floor(a),s=Math.abs(a-e)*60,k=Math.floor(s),l=(s-k)*60;return`${e}° ${k}' ${l.toFixed(2)}"`};R(()=>ce.value,()=>{if(ce.value){Q.value=5;const a=d.value.getOption();a.series.forEach(e=>{e.showAllSymbol=!0}),a.series.forEach(e=>{e.symbolSize=Q.value}),d.value.setOption(a)}else{Q.value=7;const a=d.value.getOption();a.series.forEach(e=>{e.showAllSymbol=!1}),a.series.forEach(e=>{e.symbolSize=Q.value}),d.value.setOption(a)}}),R(()=>Q.value,()=>{const a=d.value.getOption();a.series.forEach(e=>{e.symbolSize=Q.value}),d.value.setOption(a)});const st=()=>{Q.value=7,ce.value=!1;const a=d.value.getOption();a.series.forEach(e=>{e.symbolSize=Q.value,e.showAllSymbol=!1}),d.value.setOption(a)},xe=u(!1);R(()=>S.value,()=>{I.value={},Object.keys(S.value).forEach(a=>{const e=S.value[a].seriesName,s=S.value[a].data,l=s.map(v=>{const h=A.getAllTrunk().trunk1.spot.find(q=>q.name===v.seriesName);if(h!==void 0)return h.id}).filter(v=>v!==void 0);I.value[e]===void 0&&(I.value[e]=[]),l.length>0&&(I.value[e]={date:S.value[a].date,timerange:S.value[a].timerange,type:S.value[a].type,data:l.map((v,h)=>({idSpot:v,avgPsiValues:s[h].yValue}))})})},{deep:!0});const yt=(a,e)=>{const k=I.value[a].data;for(let l=0;l<k.length;l++)if(k[l].idSpot==e)return k[l].avgPsiValues.toFixed(2)};Ze(()=>{var a;if(I.value!=null&&(ke=Object.keys(I.value),he.value!=null)){Le.value=[];const e=he.value,s=(a=I.value[e])==null?void 0:a.data;ke.filter(l=>l!==e).forEach(l=>{const v=I.value[l].data,h=[];ne.value.trunk1.spot.forEach((q,Ge)=>{const Qe=q.id,Je=s.find(je=>je.idSpot===Qe),mt=v.find(je=>je.idSpot===Qe);if(Je&&mt){const je=Je.avgPsiValues.toFixed(2)-mt.avgPsiValues.toFixed(2);h[Ge]=je}else h[Ge]=0}),Le.value.push({dropKey:l,deltas:h})})}});const nt=a=>a.spot,He=u(!1),ze=u(""),Ne=u(""),Ot=()=>{x.value=!1,He.value=!0,P.value=!0},_t=()=>{He.value=!1,P.value=!1},Yt=()=>{if(ze.value==""||Ne.value==""){m.notifyShowError("Name and description are required");return}m.notifyShow("Saving preset. Please wait..."),He.value=!1;const a={name:ze.value,desc:Ne.value,selectedModel:G.value,selectedMethod:U.value,selections:S.value,seekerValue:V.value};j("onDataSave",a),ze.value="",Ne.value=""},Lt=()=>{j("onLoadPreset")},Tt=()=>{m.notifyShow("Snapshot loaded"),G.value=D.snapShots.selectedModel,U.value=D.snapShots.selectedMethod,setTimeout(()=>{V.value=D.snapShots.seekerValue,setTimeout(()=>{S.value=D.snapShots.selection;const a=d.value.getOption().series;Object.keys(S.value).forEach(s=>{const k=S.value[s];k.type==="normal"?(a.push({type:"line",name:"Normal",xAxisIndex:0,data:[],markLine:{symbol:"image://https://png.pngtree.com/png-clipart/20230325/original/pngtree-petroleum-workers-or-miners-vector-png-image_9004441.png",symbolSize:42,data:[{xAxis:k.index}],lineStyle:{color:"red",width:2,type:"dotted"},label:{show:!0,formatter:"Normal",position:"insideEndTop"}}}),he.value=k.seriesName):a.push({type:"line",name:k.name,xAxisIndex:0,data:[],markLine:{symbol:"image://https://gpng.net/wp-content/uploads/ROBBER.png",symbolSize:35,data:[{xAxis:k.index,symbolRotate:180}],lineStyle:{color:"blue",width:2,type:"dotted"},label:{show:!0,formatter:k.name,position:"insideEndTop"}}})}),d.value.setOption({series:a});const e=d.value.getOption();d.value.clear(),d.value.setOption(e)},1e3),r(V.value)},3e3)};Ze(()=>{d.value&&D.snapShots&&Object.keys(D.snapShots).length>0&&Tt()});const Vt=(a,e)=>{let s=!0;return e.forEach(k=>{a<k&&(s=!1)}),s},Et=(a,e)=>{let s=0;e.forEach(l=>{s<l&&(s=l)});let k=!0;return e.forEach(l=>{a<l&&l<s&&(k=!1)}),k},At=(a,e)=>{let s=0;e.forEach(v=>{s<v&&(s=v)});let k=0;e.forEach(v=>{k<v&&v<s&&(k=v)});let l=!0;return e.forEach(v=>{a<v&&v<k&&(l=!1)}),l},Ft=(a,e)=>{let s=!0;return e.forEach(k=>{a>k&&(s=!1)}),s},zt=()=>{d.value&&d.value.resize()},_e=u(600),Re=u(!1);R(()=>_e.value,()=>{_e.value<0&&(_e.value=0);const a=d.value.getOption();a.yAxis[0].max=_e.value,d.value.setOption(a)});const Nt=u(null),Rt=async()=>{};return(a,e)=>{const s=qe("font-awesome-icon"),k=qe("center");return o(),i(Y,null,[ye.value?(o(),i("div",Zt,[t("div",el,[e[34]||(e[34]=t("h2",null,[t("b",null,"Select Range")],-1)),e[35]||(e[35]=t("p",{style:{padding:"0",margin:"0"}},"Automatically plays the playback based on current setup",-1)),n(De,{"in-label":"Speed","model-value":ae.value,"onUpdate:modelValue":e[0]||(e[0]=l=>ae.value=l)},{default:w(()=>e[31]||(e[31]=[t("option",{value:"1000"},"Slowest",-1),t("option",{value:"500"},"Slower",-1),t("option",{value:"300"},"Moderate",-1),t("option",{value:"250"},"Faster",-1),t("option",{value:"200"},"Fastest",-1)])),_:1},8,["model-value"]),n(ve,{"in-type":"date","in-label":"Date 1","model-value":pe.value,"onUpdate:modelValue":e[1]||(e[1]=l=>pe.value=l)},null,8,["model-value"]),n(ve,{"in-type":"date","in-label":"Date 2","model-value":de.value,"onUpdate:modelValue":e[2]||(e[2]=l=>de.value=l)},null,8,["model-value"]),t("div",tl,[n($,{onClick:ht,"bt-disabled":!1,style:{width:"fit-content"}},{default:w(()=>e[32]||(e[32]=[p("Apply Filter")])),_:1}),n($,{onClick:e[3]||(e[3]=l=>ye.value=!ye.value),"bt-disabled":!1,style:{width:"fit-content"}},{default:w(()=>e[33]||(e[33]=[p("Cancel ")])),_:1})])])])):M("",!0),Ve.value?(o(),i("div",ll,[t("div",al,[e[38]||(e[38]=t("h2",null,[t("b",null,"Select Preference")],-1)),n(De,{"in-label":"Select","model-value":F.value,"onUpdate:modelValue":e[4]||(e[4]=l=>F.value=l)},{default:w(()=>e[36]||(e[36]=[t("option",{value:"forward"},"Forward",-1),t("option",{value:"backward"},"Backward",-1)])),_:1},8,["model-value"]),n($,{onClick:e[5]||(e[5]=l=>Ve.value=!Ve.value),style:{width:"fit-content"},"bt-disabled":!1},{default:w(()=>[n(s,{icon:"save"}),e[37]||(e[37]=p(" Save & Apply"))]),_:1})])])):M("",!0),e[97]||(e[97]=t("h5",{style:{"text-align":"center"}},[t("b",null,"Playback")],-1)),n(k,null,{default:w(()=>[n(De,{style:{width:"400px"},"in-label":"Speed","model-value":ae.value,"onUpdate:modelValue":e[6]||(e[6]=l=>ae.value=l)},{default:w(()=>e[39]||(e[39]=[t("option",{value:"1000"},"Slowest",-1),t("option",{value:"500"},"Slower",-1),t("option",{value:"300"},"Moderate",-1),t("option",{value:"250"},"Faster",-1),t("option",{value:"200"},"Fastest",-1)])),_:1},8,["model-value"])]),_:1}),t("div",ol,[!x.value&&!U.value&&!G.value?(o(),J($,{key:0,onClick:e[7]||(e[7]=l=>oe.value=!oe.value),"bt-disabled":!1},{default:w(()=>[n(s,{icon:"atom"}),e[40]||(e[40]=p(" Leak Detection"))]),_:1})):M("",!0),x.value?M("",!0):(o(),J($,{key:1,onClick:Lt,"bt-disabled":!1},{default:w(()=>[n(s,{icon:"download"}),e[41]||(e[41]=p(" Import Snapshot "))]),_:1})),U.value&&G.value?(o(),J($,{key:2,onClick:e[8]||(e[8]=l=>ge.value=!ge.value),"bt-disabled":!1},{default:w(()=>[n(s,{icon:"sliders"}),e[42]||(e[42]=p(" Settings "))]),_:1})):M("",!0),U.value&&G.value?(o(),J($,{key:3,style:{background:"red"},onClick:ot,"bt-disabled":!1},{default:w(()=>[n(s,{icon:"close"}),e[43]||(e[43]=p(" Quit Prediction"))]),_:1})):M("",!0)]),t("div",sl,[t("div",nl,[t("label",{class:ee([`${f(m).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Ie(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>X.value=l),type:"checkbox"},null,512),[[Ue,X.value]]),e[44]||(e[44]=p(" Auto-replay "))],2),t("label",{class:ee([`${f(m).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Ie(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>H.value=l),type:"checkbox"},null,512),[[Ue,H.value]]),e[45]||(e[45]=p(" Autoplay on navigating "))],2),t("label",{class:ee([`${f(m).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Ie(t("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>L.value=l),type:"checkbox"},null,512),[[Ue,L.value]]),e[46]||(e[46]=p(" Self Navigate "))],2),L.value?(o(),J($,{key:0,onClick:e[12]||(e[12]=l=>Ve.value=!Ve.value),"bt-disabled":!1,type:"button",class:"slfnavbtn"},{default:w(()=>[n(s,{icon:"sliders"})]),_:1})):M("",!0)]),t("div",il,[ue.value?(o(),i("label",{key:0,class:ee([`${f(m).textTheme}`]),style:{border:"1px solid #ccc",padding:"10px","border-radius":"10px"}},[p(y(f(O)(pe.value).format("ddd, DD MMM YY"))+"    ",1),n(s,{icon:F.value=="forward"?"caret-right":"caret-left"},null,8,["icon"]),p("    "+y(f(O)(de.value).format("ddd, DD MMM YY")),1)],2)):M("",!0),ue.value?(o(),i("label",{key:1,class:ee([`${f(m).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","border-radius":"10px"}},[Ie(t("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>Be.value=l),type:"checkbox"},null,512),[[Ue,Be.value]]),e[47]||(e[47]=p(" Repeat "))],2)):M("",!0),n($,{onClick:e[14]||(e[14]=l=>ye.value=!ye.value),"bt-disabled":!1,type:"button",class:"slfnavbtn"},{default:w(()=>[n(s,{icon:"calendar"})]),_:1}),pe.value&&de.value?(o(),J($,{key:2,onClick:Ee,"bt-disabled":!1,class:"slfnavbtn"},{default:w(()=>[n(s,{icon:"close"})]),_:1})):M("",!0)])]),t("div",rl,[n($,{"bt-disabled":be.value,onClick:Z},{default:w(()=>[n(s,{icon:"backward"}),p("    "+y(f(O)(Pe.value).format("ddd, DD MMM YY")),1)]),_:1},8,["bt-disabled"]),t("span",ul,[t("b",{style:B({color:`${f(m).accentColor}`})},y(f(O)(D.initDateFilter).format("ddd, DD MMM YY")),5),e[51]||(e[51]=t("br",null,null,-1)),ue.value?(o(),i("span",{key:0,class:ee([`${f(m).textTheme}`]),style:{"font-size":"11px"}},[e[48]||(e[48]=p("Stops at: ")),t("b",null,y(f(O)(de.value).format("ddd, DD MMM YY")),1)],2)):(o(),i(Y,{key:1},[X.value?(o(),i("span",dl,[e[49]||(e[49]=p("Repeating: ")),t("b",null,y(f(O)(D.initDateFilter).format("ddd, DD MMM YY")),1)])):(o(),i(Y,{key:1},[Ce.value?(o(),i("span",vl,"[End of playback  ·  Autoplay stopped]")):(o(),i("span",pl,[e[50]||(e[50]=p("Upcoming: ")),t("b",null,y(f(O)(kt()).format("ddd, DD MMM YY")),1)]))],64))],64))]),n($,{"bt-disabled":Ce.value,onClick:N},{default:w(()=>[p(y(f(O)(re.value).format("ddd, DD MMM YY"))+"    ",1),n(s,{icon:"forward"})]),_:1},8,["bt-disabled"])]),t("div",{style:B([{position:"relative",width:"100%"},{marginBottom:Object.keys(S.value).length>1?"8rem":"0"}])},[t("div",{ref_key:"heatMap",ref:le,style:{width:"100%",height:"600px"}},null,512),t("div",cl,[t("div",fl,[x.value?M("",!0):(o(),i("button",{key:0,style:{"z-index":"1",position:"relative"},onClick:e[15]||(e[15]=l=>x.value=!x.value),class:"controlbtn",type:"button"},[n(s,{icon:"play"})])),x.value?(o(),i("button",{key:1,style:{"z-index":"1",position:"relative"},onClick:e[16]||(e[16]=l=>x.value=!x.value),class:"controlbtn",type:"button"},[n(s,{icon:"pause"})])):M("",!0)]),t("div",yl,[t("input",{onChange:E,type:"range",min:0,max:D.initPlaybackDatas.length,value:V.value,class:"slider"},null,40,ml)]),t("div",null,[!x.value&&V.value==D.initPlaybackDatas.length?(o(),i("button",{key:0,onClick:c,class:"controlbtn",type:"button"},[n(s,{icon:"undo"})])):M("",!0)])]),Object.keys(S.value).length?(o(),i("div",bl,[t("div",gl,[(o(!0),i(Y,null,K(S.value,(l,v)=>(o(),i("div",{key:v,class:"selection-item",onClick:h=>xt(l,v)},[t("h5",{style:B({color:l.type=="normal"?"red":"blue"})},[t("b",null,y(l.name),1)],4),(o(!0),i(Y,null,K(l.data,h=>(o(),i("div",{key:h.seriesName},[h.seriesName!="Normal"&&!h.seriesName.includes("Drop")?(o(),i("span",hl,[t("span",wl,y(h.seriesName),1),e[52]||(e[52]=p()),t("span",xl,[t("b",null,y(h.yValue)+" PSI",1)])])):M("",!0)]))),128))],8,kl))),128))]),t("div",Dl,[e[57]||(e[57]=t("h4",{style:{"text-align":"center"}},[t("b",null,"Pressure Distribution")],-1)),T.value?(o(),J(Xt,{key:0,style:{width:"100%"},data:f(I),"selected-spot":"trunk1"},null,8,["data"])):M("",!0),t("img",{src:f(Ut),alt:"map",style:{width:"100%",height:"600px","border-radius":"10px","object-fit":"contain"}},null,8,Sl),t("div",Ml,[t("h5",Cl,[t("b",null,[n(s,{icon:"oil-well"}),e[53]||(e[53]=p(" Selected Pressures"))])]),t("table",$l,[t("thead",null,[t("tr",{style:{padding:"5px"},class:ee([`${f(m).textTheme}`])},[t("th",{style:B({border:`1px solid ${f(m).accentColor}`})},"ACTION",4),t("th",{style:B({border:`1px solid ${f(m).accentColor}`})},"PINNED SERIES",4),(o(!0),i(Y,null,K(nt(ne.value.trunk1),(l,v)=>(o(),i("th",{style:B({border:`1px solid ${f(m).accentColor}`}),key:v},y(l.name),5))),128))],2)]),t("tbody",null,[(o(!0),i(Y,null,K(f(ke),(l,v)=>(o(),i("tr",{key:v},[t("td",{style:B({border:`1px solid ${f(m).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},null,4),t("td",{class:ee([`${f(m).textTheme}`]),style:B({border:`1px solid ${f(m).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},[p(y(f(I)[l].date),1),e[54]||(e[54]=t("br",null,null,-1)),p(" "+y(f(I)[l].timerange),1),e[55]||(e[55]=t("br",null,null,-1)),p(" "+y(f(I)[l].type),1)],6),(o(!0),i(Y,null,K(nt(ne.value.trunk1),(h,q)=>(o(),i("td",{style:B({border:`1px solid ${f(m).accentColor}`}),class:ee([`${f(m).textTheme}`]),key:q},[yt(l,h.id)?(o(),i(Y,{key:0},[p(y(yt(l,h.id)),1)],64)):(o(),i(Y,{key:1},[p("0.00")],64))],6))),128))]))),128))])]),t("h5",Pl,[t("b",null,[n(s,{icon:"turn-down"}),e[56]||(e[56]=p(" Delta"))])]),t("table",Ol,[t("thead",null,[t("tr",{style:{padding:"5px"},class:ee([`${f(m).textTheme}`])},[t("th",{style:B({border:`1px solid ${f(m).accentColor}`})},"DROPS",4),t("th",{style:B({border:`1px solid ${f(m).accentColor}`})},"PINNED SERIES",4),(o(!0),i(Y,null,K(nt(ne.value.trunk1),(l,v)=>(o(),i("th",{style:B({border:`1px solid ${f(m).accentColor}`}),key:v},y(l.name),5))),128))],2)]),t("tbody",null,[(o(!0),i(Y,null,K(Le.value,(l,v)=>(o(),i("tr",{key:v},[t("td",{style:B({border:`1px solid ${f(m).accentColor}`})},y(v+1),5),t("td",{style:B({border:`1px solid ${f(m).accentColor}`})},y(l.dropKey.split(".")[0]+"."+l.dropKey.split(".")[1]+"."+l.dropKey.split(".")[2]),5),(o(!0),i(Y,null,K(l.deltas,(h,q)=>(o(),i("td",{key:q,style:B({border:`1px solid ${f(m).accentColor}`})},[Vt(h,l.deltas)?(o(),i("span",_l,y(h.toFixed(2)),1)):Et(h,l.deltas)?(o(),i("span",Yl,y(h.toFixed(2)),1)):At(h,l.deltas)?(o(),i("span",Ll,y(h.toFixed(2)),1)):Ft(h,l.deltas)?(o(),i("span",Tl,y(h.toFixed(2)),1)):(o(),i("span",Vl,y(h.toFixed(2)),1))],4))),128))]))),128))])])])])])):M("",!0)],4),Me.value?(o(),i("div",El,e[58]||(e[58]=[t("img",{src:"https://cdn.dribbble.com/users/1138184/screenshots/3796132/oil.gif"},null,-1)]))):M("",!0),oe.value?(o(),i("div",Al,[t("div",Fl,[t("button",{onClick:Dt,class:"modelpick-dismiss"},[n(s,{icon:"times"})]),e[61]||(e[61]=t("h2",null,[t("b",null,"Leak Detection")],-1)),n(De,{"in-label":"Select Model","model-value":G.value,"onUpdate:modelValue":e[17]||(e[17]=l=>G.value=l)},{default:w(()=>e[59]||(e[59]=[t("option",{value:""},"Select...",-1),t("option",{value:"normal_pick"},"Normal Pick",-1),t("option",{value:"ranged_pick"},"Ranged Pick",-1)])),_:1},8,["model-value"]),n(De,{"in-label":"Select Prediction Method","model-value":U.value,"onUpdate:modelValue":e[18]||(e[18]=l=>U.value=l)},{default:w(()=>e[60]||(e[60]=[t("option",{value:""},"Select method...",-1),t("option",{value:"rf_multi"},"RF Multi-leak",-1),t("option",{value:"dtree_multi"},"DTree Multi-leak",-1),t("option",{value:"rf_single"},"RF Single-leak",-1),t("option",{value:"eqlr_single"},"EQ-Based LR Single-leak",-1)])),_:1},8,["model-value"]),n($,{onClick:e[19]||(e[19]=l=>oe.value=!oe.value),style:{width:"fit-content","margin-top":"0.5rem"},"bt-disabled":!1},{default:w(()=>[p(y(Ae.value?"Update Preference":"Start Picking"),1)]),_:1})])])):M("",!0),Object.keys(S.value).length>1&&!xe.value?(o(),i("div",zl,[t("button",{type:"button",class:"predict-action-hide",onClick:e[20]||(e[20]=l=>xe.value=!xe.value)},[n(s,{icon:"eye-slash"})]),t("div",Nl,[e[62]||(e[62]=p("Picking Model: ")),t("b",null,y(G.value.split("_").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")),1),e[63]||(e[63]=p(" ··· Prediction Method: ")),t("b",null,y(U.value.split("_").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")),1)]),t("div",Rl,[e[64]||(e[64]=p("Num of drops: ")),t("b",null,y(Object.keys(S.value).filter(l=>S.value[l].type=="drop").length),1)]),t("div",jl,[n($,{"bt-size":"small",onClick:Ct,"bt-disabled":!1,style:{width:"fit-content"}},{default:w(()=>[n(s,{icon:"check"}),e[65]||(e[65]=p(" Predict "))]),_:1}),n($,{"bt-size":"small",onClick:Ot,"bt-disabled":!1,style:{width:"fit-content",background:"rgb(0,150,255)"}},{default:w(()=>[n(s,{icon:"plus"}),e[66]||(e[66]=p(" Create Snapshot "))]),_:1}),n($,{"bt-size":"small",onClick:St,"bt-disabled":!1,style:{width:"fit-content",background:"#666"}},{default:w(()=>[n(s,{icon:"refresh"}),e[67]||(e[67]=p(" Change Method "))]),_:1}),n($,{"bt-size":"small",onClick:Te,"bt-disabled":!1,style:{width:"fit-content",background:"orange"}},{default:w(()=>[n(s,{icon:"trash"}),e[68]||(e[68]=p(" Clear Selection "))]),_:1}),n($,{"bt-size":"small",onClick:ot,"bt-disabled":!1,style:{width:"fit-content",background:"red"}},{default:w(()=>[n(s,{icon:"close"}),e[69]||(e[69]=p(" Quit Prediction "))]),_:1})])])):M("",!0),Fe.value?(o(),i("div",Il,[t("div",{class:ee(["leak-body",[`${f(m).mTheme}`]])},[t("button",{type:"button",onClick:e[21]||(e[21]=l=>Fe.value=!1),class:"leak-dismiss"},[n(s,{icon:"times"})]),t("div",{class:"l-left",style:B({width:Oe.value?"40%":"100%"})},[e[82]||(e[82]=t("h4",{style:{"font-weight":"bold"}},"Leak Analysis",-1)),e[83]||(e[83]=t("hr",null,null,-1)),se.value?(o(!0),i(Y,{key:0},K(se.value,(l,v)=>(o(),i("div",{class:"analysis-set",key:v},[l!=!1?(o(),i(Y,{key:0},[t("h4",Ul,[t("b",null," DROP "+y(l.drop),1)]),t("p",null,[e[80]||(e[80]=p(" Result: ")),l!=!1&&l.suspectLocation.leak?(o(),i(Y,{key:0},[e[78]||(e[78]=t("b",{style:{color:"red"}},"Possible leak detected!",-1)),t("div",ql,[t("table",Bl,[t("tr",null,[e[70]||(e[70]=t("th",{style:{border:"1px solid #ccc",padding:"10px"}},"Estimated Leak Point",-1)),l.suspectLocation.leakData.pu_location?(o(),i("th",Kl," PU ")):M("",!0),l.suspectLocation.leakData.coordinate?(o(),i("th",Wl," Coordinate ")):M("",!0)]),t("tbody",null,[t("tr",null,[t("td",Hl,y(l.suspectLocation.leakData.leak_point)+" KM ",1),l.suspectLocation.leakData.pu_location?(o(),i("td",Gl," KM "+y(l.suspectLocation.leakData.pu_location),1)):M("",!0),l.suspectLocation.leakData.coordinate?(o(),i("td",Ql,[e[72]||(e[72]=p(" LatLng: ")),t("code",null,y(l.suspectLocation.leakData.coordinate.latitude+", "+l.suspectLocation.leakData.coordinate.longitude),1),e[73]||(e[73]=t("br",null,null,-1)),e[74]||(e[74]=p(" DMS: ")),t("code",null,y(`${We(l.suspectLocation.leakData.coordinate.latitude)}, ${We(l.suspectLocation.leakData.coordinate.longitude)}`),1),e[75]||(e[75]=t("br",null,null,-1)),n($,{onClick:h=>Pt(`LATLNG: ${l.suspectLocation.leakData.coordinate.latitude}, ${l.suspectLocation.leakData.coordinate.longitude}
DMS: ${We(l.suspectLocation.leakData.coordinate.latitude)}, ${We(l.suspectLocation.leakData.coordinate.longitude)}`),style:{"margin-top":"5px"},"bt-disabled":!1,"bt-size":"small"},{default:w(()=>[n(s,{icon:"copy"}),e[71]||(e[71]=p(" Copy Coord "))]),_:2},1032,["onClick"])])):M("",!0)])])])]),l.suspectLocation.leakData.coordinate?M("",!0):(o(),i("p",Jl,[n(s,{icon:"info-circle"}),e[76]||(e[76]=p(" Map view and PU Location data is currently not supported for this line "))])),n($,{onClick:h=>$t(l.suspectLocation.leakData.coordinate,l.suspectLocation.leakData.leak_point,l.suspectLocation.leakData.pu_location),"bt-disabled":!l.suspectLocation.leakData.coordinate},{default:w(()=>[n(s,{icon:"map-marker"}),e[77]||(e[77]=p(" Pinpoint on Map"))]),_:2},1032,["onClick","bt-disabled"]),l.suspectLocation.leakData.coordinate?(o(),i("a",{key:1,class:"gmaps",target:"_blank",href:`https://www.google.com/maps?q=${l.suspectLocation.leakData.coordinate.latitude},${l.suspectLocation.leakData.coordinate.longitude}`,style:{"margin-left":"0.5rem"}},"Google Maps",8,Xl)):M("",!0)],64)):(o(),i(Y,{key:1},[e[79]||(e[79]=t("b",{style:{color:"#555"}},"No leak detected",-1)),t("ol",Zl,[(o(!0),i(Y,null,K(l.suspectLocation.probabilities,(h,q)=>(o(),i("li",{key:q},y(h),1))),128))])],64))])],64)):(o(),i("h6",ea,[t("b",null,"Analysis on Dataset "+y(v+1),1),e[81]||(e[81]=t("b",{style:{color:"#555"}},"Tidak ada indikasi",-1)),t("ol",ta,[(o(!0),i(Y,null,K(l.suspectLocation.probabilities,(h,q)=>(o(),i("li",{key:q},y(h),1))),128))])]))]))),128)):(o(),J(qt,{key:1,message:"Calculating leak probabilities..."}))],4),Oe.value?(o(),i("div",{key:0,class:"l-right",style:B({width:Oe.value?"60%":"100%",position:"relative"})},[e[84]||(e[84]=t("h4",{style:{"font-weight":"bold"}},"Map View",-1)),e[85]||(e[85]=t("hr",null,null,-1)),n(Bt,{latitude:Ke.value.latitude,longitude:Ke.value.longitude,"leak-point":ct.value,"pu-location":ft.value},null,8,["latitude","longitude","leak-point","pu-location"])],4)):M("",!0),t("div",la,[t("div",aa,[n($,{onClick:Rt,style:{width:"fit-content"},"bt-disabled":!1},{default:w(()=>e[86]||(e[86]=[p("Export Result")])),_:1}),t("div",{ref_key:"pdfRef",ref:Nt},e[87]||(e[87]=[t("h3",null,"Halo, ini isi PDF gue, bro!",-1),t("p",null," Bebas isi apa aja, misal paragraf, gambar, tabel, dsb. Nanti akan kita tangkap lalu convert ke PDF. ",-1)]),512)])])],2)])):M("",!0),ge.value?(o(),i("div",oa,[t("div",sa,[e[90]||(e[90]=t("h5",null,[t("b",null,"Prediction Mode Preferences")],-1)),e[91]||(e[91]=t("hr",null,null,-1)),n(ve,{"in-label":"Dot Symbol Size","model-value":Q.value,"onUpdate:modelValue":e[22]||(e[22]=l=>Q.value=l),"in-type":"number"},null,8,["model-value"]),t("label",na,[Ie(t("input",{type:"checkbox","onUpdate:modelValue":e[23]||(e[23]=l=>ce.value=l)},null,512),[[Ue,ce.value]]),e[88]||(e[88]=t("div",{style:{display:"flex","flex-flow":"column","margin-left":"0.7rem"}},[t("span",{style:{"font-size":"13px"}},[t("b",null,"Show all dots")]),t("span",{style:{"font-size":"11px"}},"Show all dots or reduce the dot placement")],-1))]),n($,{onClick:e[24]||(e[24]=l=>ge.value=!ge.value),style:{width:"fit-content"},"bt-disabled":!1},{default:w(()=>e[89]||(e[89]=[p("Save Preferences")])),_:1})])])):M("",!0),He.value?(o(),i("div",ia,[t("div",ra,[e[94]||(e[94]=t("h2",null,[t("b",null,"Snapshot")],-1)),n(ve,{"in-label":"Name","model-value":ze.value,"onUpdate:modelValue":e[25]||(e[25]=l=>ze.value=l),"in-type":"text"},null,8,["model-value"]),n(ve,{"in-label":"Description","model-value":Ne.value,"onUpdate:modelValue":e[26]||(e[26]=l=>Ne.value=l),"in-type":"text"},null,8,["model-value"]),t("div",ua,[n($,{onClick:Yt,style:{width:"fit-content"},"bt-disabled":!1},{default:w(()=>[n(s,{icon:"save"}),e[92]||(e[92]=p(" Create "))]),_:1}),n($,{onClick:_t,style:{width:"fit-content"},"bt-disabled":!1},{default:w(()=>e[93]||(e[93]=[p("Cancel ")])),_:1})])])])):M("",!0),Re.value?(o(),i("div",da,[t("div",pa,[t("button",va,[n(s,{icon:"times"})]),e[96]||(e[96]=t("h4",null,[t("b",null,"Playback Chart Option")],-1)),n(ve,{"in-label":"Y Axis Max","in-type":"number","model-value":_e.value,"onUpdate:modelValue":e[27]||(e[27]=l=>_e.value=l)},null,8,["model-value"]),n($,{"bt-size":"normal",onClick:e[28]||(e[28]=l=>Re.value=!Re.value),"bt-type":"button","bt-disabled":!1,style:{width:"fit-content"}},{default:w(()=>e[95]||(e[95]=[p("Apply")])),_:1})])])):M("",!0),xe.value?(o(),i("button",{key:9,type:"button",onClick:e[29]||(e[29]=l=>xe.value=!xe.value),class:"predict-action-show"},[n(s,{icon:"eye"})])):M("",!0),xe.value?M("",!0):(o(),i("button",{key:10,type:"button",onClick:zt,class:"chart-resize"},[n(s,{icon:"left-right"})])),t("button",{type:"button",onClick:e[30]||(e[30]=l=>Re.value=!Re.value),class:"chart-options"},[n(s,{icon:"gear"})])],64)}}}),fa=ut(ca,[["__scopeId","data-v-0a1cbffd"]]),ya={class:"dateselect-window"},ma={class:"dateselect-inner"},ba={class:"calendar-navigation"},ga={style:{"font-size":"19px"}},ka={class:"calendar-days"},ha=["onClick"],wa={key:0,style:{color:"orange","font-weight":"bold"}},xa={key:1},Da={style:{"margin-top":"1rem",display:"flex","flex-flow":"row nowrap","justify-content":"space-between"}},Sa={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},Ma=et({__name:"DateSelectView",props:{calendarTitle:{type:String,default:"Select Dates"},initialDates:{type:Array,default:()=>[]}},emits:["onApply","onClose"],setup(Se,{emit:te}){const _=u(O().format("YYYY-MM-DD")),A=u([]),j=te,m=Se;R(()=>A.value,L=>{A.value=L.sort((g,T)=>new Date(g).getTime()-new Date(T).getTime())},{deep:!0});const F=()=>{j("onApply",A.value)};return Ze(()=>{m.initialDates.length&&(A.value=m.initialDates)}),(L,g)=>{const T=qe("font-awesome-icon");return o(),i("div",ya,[t("div",ma,[t("h4",null,[t("b",null,[n(T,{icon:"calendar"}),p(" "+y(m.calendarTitle),1)])]),g[7]||(g[7]=t("hr",null,null,-1)),t("div",ba,[t("button",{class:"navmonth-btn",onClick:g[0]||(g[0]=P=>_.value=f(O)(_.value).subtract(1,"month").format("YYYY-MM-DD"))},[n(T,{icon:"angle-left"}),p(" "+y(f(O)(_.value).subtract(1,"month").format("MMMM")),1)]),t("h3",ga,[t("b",null,y(f(O)(_.value).format("MMMM YYYY")),1)]),t("button",{class:"navmonth-btn",onClick:g[1]||(g[1]=P=>_.value=f(O)(_.value).add(1,"month").format("YYYY-MM-DD"))},[p(y(f(O)(_.value).add(1,"month").format("MMMM"))+" ",1),n(T,{icon:"angle-right"})])]),g[8]||(g[8]=Ht('<div class="calendar-days" data-v-ed809d3b><div class="calendar-day-week" data-v-ed809d3b>Sen</div><div class="calendar-day-week" data-v-ed809d3b>Sel</div><div class="calendar-day-week" data-v-ed809d3b>Rab</div><div class="calendar-day-week" data-v-ed809d3b>Kam</div><div class="calendar-day-week" data-v-ed809d3b>Jum</div><div class="calendar-day-week" data-v-ed809d3b>Sab</div><div class="calendar-day-week" data-v-ed809d3b>Min</div></div>',1)),t("div",ka,[(o(!0),i(Y,null,K(f(O)(_.value).startOf("month").day(),P=>(o(),i("div",{key:P,class:"calendar-day-unclickable"}))),128)),(o(!0),i(Y,null,K(f(O)(_.value).daysInMonth(),P=>(o(),i("div",{key:P,class:"calendar-day",onClick:D=>A.value.includes(f(O)(_.value).date(P).format("YYYY-MM-DD"))?A.value.splice(A.value.indexOf(f(O)(_.value).date(P).format("YYYY-MM-DD")),1):A.value.push(f(O)(_.value).date(P).format("YYYY-MM-DD")),style:B({background:A.value.includes(f(O)(_.value).date(P).format("YYYY-MM-DD"))?"#aaaaaa":"#f0f0f0"})},[f(O)(_.value).date(P).format("YYYY-MM-DD")==f(O)().format("YYYY-MM-DD")?(o(),i("span",wa,y(P),1)):(o(),i("span",xa,y(P),1))],12,ha))),128)),(o(!0),i(Y,null,K(6-f(O)(_.value).endOf("month").day(),P=>(o(),i("div",{key:P,class:"calendar-day-unclickable"}))),128))]),t("div",Da,[n($,{onClick:F,"bt-disabled":!A.value.length},{default:w(()=>g[4]||(g[4]=[p("Apply Selections")])),_:1},8,["bt-disabled"]),t("div",Sa,[A.value.length?(o(),J($,{key:0,style:{background:"red"},onClick:g[2]||(g[2]=P=>A.value=[]),"bt-disabled":!1},{default:w(()=>[n(T,{icon:"trash"}),g[5]||(g[5]=p(" Clear"))]),_:1})):M("",!0),n($,{onClick:g[3]||(g[3]=P=>j("onClose")),"bt-disabled":!1},{default:w(()=>[n(T,{icon:"times"}),g[6]||(g[6]=p(" Close"))]),_:1})])])])])}}}),Ca=ut(Ma,[["__scopeId","data-v-ed809d3b"]]),$a={class:"row"},Pa={class:"col-md-3"},Oa=["value"],_a={style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},Ya={style:{display:"flex","flex-flow":"row nowrap",gap:"1rem","align-items":"center"}},La={class:"col-md-12",style:{position:"relative"}},Ta={key:0,class:"loaders"},Va={key:0,class:"load-window"},Ea={class:"load-inner"},Aa={style:{display:"flex","flex-flow":"column","align-items":"flex-start",gap:"0.2rem"}},Fa={style:{margin:"0",padding:"0"}},za={style:{"font-size":"9px",color:"red"}},Na={style:{"font-size":"11px","margin-bottom":"1rem"}},Ra={style:{display:"flex","flex-flow":"row wrap","font-size":"11px",gap:"0.2rem",border:"1px solid #ccc",width:"100%",padding:"10px","border-radius":"10px"}},ja={style:{color:"#555",padding:"5px",background:"#ddd","border-radius":"5px"}},Ia={style:{display:"flex","flex-flow":"row wrap","font-size":"11px",gap:"0.2rem",border:"1px solid #ccc",width:"100%",padding:"10px","border-radius":"10px"}},Ua={style:{color:"#555",padding:"10px",background:"#eee","border-radius":"5px","text-align":"center"}},qa={style:{display:"flex","flex-flow":"row wrap","font-size":"12px",background:"#eee",padding:"10px","border-radius":"10px",border:"1px solid #ccc",width:"100%"}},Ba={style:{"margin-right":"10px","font-weight":"bold"}},Ka={style:{"font-weight":"bold"}},Wa={style:{"font-weight":"bold"}},Ha={style:{"font-weight":"bold"}},Ga={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},Qa={key:1,style:{display:"flex","flex-flow":"column","align-items":"center","justify-content":"center",gap:"1rem"}},Ja={style:{"font-size":"30px"}},Xa=et({__name:"PlaybackFol",setup(Se){const te=it(),_=bt();_.asideToggle(!1);const A=u(te.getAllTrunk()),j=u("trunk1"),m=u();m.value=Object.keys(A.value);const F=u(5),L=u(),g=u([]),T=u(0),P=u([]),D=u(!1),le=u(!1),d=u(!1);u(!1);const ne=u(!0),V=u({}),Ye=gt(),me=()=>{T.value++,g.value.push(null)};rt(()=>{const b=Ye.params.saveid;b?setTimeout(async()=>{const r="https://rtunode.findingoillosses.com/api/v1/getpresetbyid",C={key:b},c=await Xe.post(r,C),E=c.data.status,z=c.data.data;if(E===200){const N=z;P.value=[],g.value=[];const Z=N.dates;T.value=0,F.value=N.timerange,L.value=Z[0];for(let fe=1;fe<Z.length;fe++)me();setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((fe,we)=>{fe.value=Z[we],g.value[we]=fe}),W(),V.value={name:N.name,desc:N.desc,selectedMethod:N.selectedMethod,selectedModel:N.selectedModel,selection:N.selections,seekerValue:N.seekerValue},D.value=!0},100)}else _.notifyShowError("Failed fetching snapshot!")},1e3):(Me(),D.value=!0)}),R(()=>[L.value,F.value,j.value],async()=>{V.value={},le.value=!0,await W()});const Me=()=>{const b=new Date,r=b.getFullYear(),C=String(b.getMonth()+1).padStart(2,"0"),c=String(b.getDate()).padStart(2,"0"),E=`${r}-${C}-${c}`;L.value=E},ae=async b=>new Promise(async(r,C)=>{try{const c=A.value[j.value];let E=[];for(let Z=0;Z<c.spot.length;Z++)E.push(c.spot[Z].id);const z={datefilter:b,timeFilter:F.value,idFilter:E},N=await Xe.post(Gt.baseEnd+"api/History/getsplittedhistdata",z);r(N.data)}catch(c){C(c)}}),W=async()=>{try{d.value=!0;let r=[...await ae(L.value)];if(g.value.length>0){for(let C=0;C<g.value.length;C++){const c=g.value[C];if(c!==null){if(c.value!==L.value){const E=await ae(c.value);r=r.concat(E)}}else console.log("Null")}le.value=!1}P.value=r,d.value=!1}catch(b){console.log(b),le.value=!1,d.value=!1}},Ce=async()=>new Promise(async(b,r)=>{try{d.value=!0;let c=[...await ae(L.value)];if(g.value.length>0){for(let E=0;E<g.value.length;E++){const z=g.value[E];if(z!==null){if(z.value!==L.value){const N=await ae(z.value);c=c.concat(N)}}else console.log("Null")}le.value=!1}P.value=c,d.value=!1,b(!0)}catch(C){console.log(C),le.value=!1,d.value=!1,r(!1)}}),ie=(b,r)=>{g.value[r]=b,W()},$e=()=>{T.value>0&&(T.value--,g.value.pop()),W()},tt=b=>{L.value=b},re=u([]),Pe=async b=>{X();const r={};r.name=b.name,r.desc=b.desc,r.timerange=F.value,r.selectedModel=b.selectedModel,r.selectedMethod=b.selectedMethod,r.dates=re.value,r.selections=b.selections,r.seekerValue=b.seekerValue,r.context="rtufol",(await Xe.post("https://rtunode.findingoillosses.com/api/v1/savepreset",r)).data.status===200?(_.notifyShow("Preset has been saved!"),re.value=[]):(_.notifyShowError("Failed saving preset!"),re.value=[])},X=()=>{if(re.value.push(L.value),g.value.length)for(let b in g.value)re.value.push(g.value[b].value)},H=u([]),x=u(!1),be=()=>{x.value=!0,ge()},ge=async()=>{const b={context:"rtufol"},r=await Xe.post("https://rtunode.findingoillosses.com/api/v1/getpresets",b);r.data.status===200?H.value=r.data.data:_.notifyShowError("Failed fetching snapshots!")},ce=async b=>{ne.value=!1,P.value=null,g.value=[];const r=b.dates;T.value=0,F.value=b.timerange,L.value=r[0];for(let C=1;C<r.length;C++)me();Q(r).then(async()=>{await Ce().then(()=>{V.value={name:b.name,desc:b.desc,selectedMethod:b.selectedMethod,selectedModel:b.selectedModel,selection:b.selections,seekerValue:b.seekerValue},x.value=!1,setTimeout(()=>{ne.value=!0},1e3)})})},Q=b=>new Promise((r,C)=>{try{setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((c,E)=>{c.value=b[E],g.value[E]=c}),r(!0)},50)}catch(c){C(c)}}),lt=b=>{const r=`https://rantau.findingoillosses.com/fol/playback/${b.key}`;navigator.clipboard.writeText(r).then(()=>{_.notifyShow(`${b.name} -> Link copied. CTRL+V to paste`)}),x.value=!1},I=u(!1),ke=u([]),he=b=>{ke.value=b,I.value=!1,L.value=b[0],g.value=[],T.value=0;for(let r=1;r<b.length;r++)me();setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((r,C)=>{r.value=b[C],g.value[C]=r}),W()},100)},Le=()=>{g.value=[],ke.value=[],T.value=0,W()},at=()=>{I.value=!1};return(b,r)=>{const C=qe("font-awesome-icon");return o(),i(Y,null,[n(jt,{"context-title":"Playback"},{default:w(()=>[t("div",$a,[t("div",Pa,[n(De,{"in-label":"Select Line","model-value":j.value,"onUpdate:modelValue":r[0]||(r[0]=c=>j.value=c)},{default:w(()=>[(o(!0),i(Y,null,K(m.value,(c,E)=>(o(),i("option",{key:E,value:c},y(A.value[c].name),9,Oa))),128))]),_:1},8,["model-value"]),n(De,{"in-label":"Time Range","model-value":F.value,"onUpdate:modelValue":r[1]||(r[1]=c=>F.value=c)},{default:w(()=>r[6]||(r[6]=[t("option",{value:"1"},"1 Menit",-1),t("option",{value:"2"},"2 Menit",-1),t("option",{value:"3"},"3 Menit",-1),t("option",{value:"4"},"4 Menit",-1),t("option",{value:"5"},"5 Menit",-1),t("option",{value:"10"},"10 Menit",-1),t("option",{value:"15"},"15 Menit",-1),t("option",{value:"30"},"30 Menit",-1),t("option",{value:"60"},"60 Menit",-1)])),_:1},8,["model-value"]),t("div",_a,[n(ve,{"in-type":"date","in-label":"Date Filter","model-value":L.value,"onUpdate:modelValue":r[2]||(r[2]=c=>L.value=c),style:{width:"100%"}},null,8,["model-value"])]),t("div",Ya,[n($,{onClick:$e,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:w(()=>[n(C,{icon:"minus"})]),_:1}),t("span",{class:ee([`${f(_).textTheme}`])},y(T.value),3),n($,{onClick:me,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:w(()=>[n(C,{icon:"plus"})]),_:1})]),(o(!0),i(Y,null,K(T.value,(c,E)=>(o(),i("div",{key:E,style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},[n(ve,{"in-type":"date","in-label":`Date Filter ${c}`,onOnValueChange:z=>ie(z,E),style:{width:"100%"}},null,8,["in-label","onOnValueChange"])]))),128)),n($,{"bt-size":"normal","bt-type":"button",onClick:r[3]||(r[3]=c=>I.value=!I.value),"bt-disabled":!1,style:{"margin-top":"0.5rem",width:"fit-content"}},{default:w(()=>[n(C,{icon:"calendar"}),r[7]||(r[7]=p(" Select Dates "))]),_:1}),g.value.length>0?(o(),J($,{key:0,"bt-size":"normal","bt-type":"button",onClick:Le,"bt-disabled":!1,style:{"margin-top":"0.5rem","margin-left":"5px",width:"fit-content",background:"red"}},{default:w(()=>[n(C,{icon:"trash"}),r[8]||(r[8]=p(" Clear Dates "))]),_:1})):M("",!0)]),t("div",La,[d.value&&D.value?(o(),i("div",Ta,r[9]||(r[9]=[t("img",{src:"https://cdn.dribbble.com/users/1138184/screenshots/3796132/oil.gif",style:{width:"350px",height:"350px","object-fit":"contain","border-radius":"20px"}},null,-1)]))):M("",!0),P.value&&ne.value?(o(),J(fa,{key:1,"snap-shots":V.value,onOnDataSave:Pe,onOnLoadPreset:be,"init-date-filter":L.value,"selected-spot":j.value,"init-playback-datas":P.value,onOnDateChange:tt},null,8,["snap-shots","init-date-filter","selected-spot","init-playback-datas"])):M("",!0)])])]),_:1}),x.value?(o(),i("div",Va,[t("div",Ea,[t("button",{type:"button",class:"load-dismiss",onClick:r[4]||(r[4]=c=>x.value=!x.value)},[n(C,{icon:"times"})]),H.value.length>0?(o(),i(Y,{key:0},[r[15]||(r[15]=t("h2",{style:{"padding-left":"1rem"}},[t("b",null,"Saved Snapshots")],-1)),(o(!0),i(Y,null,K(H.value,(c,E)=>(o(),i("div",{class:"preset-item",key:E},[t("div",Aa,[t("h5",Fa,[t("b",null,[p(y(c.name)+" ",1),t("sup",za,[t("b",null,"#"+y(c.key),1)])])]),t("div",Na,[r[10]||(r[10]=p("Description: ")),t("b",null,y(c.desc),1)]),t("div",Ra,[(o(!0),i(Y,null,K(c.dates,(z,N)=>(o(),i("div",{key:N,style:{"font-weight":"bold"}},[t("div",ja,[t("b",null,[n(C,{icon:"calendar"}),p(" "+y(z),1)])])]))),128))]),t("div",Ia,[(o(!0),i(Y,null,K(c.selections,(z,N)=>(o(),i("div",{key:N,style:{"font-weight":"bold",width:"150px"}},[t("div",Ua,[t("b",{style:B({color:`${z.type=="drop"?"red":"green"}`})},y(`${z.name}: (${z.timerange})`),5)])]))),128))]),t("div",qa,[t("span",Ba,[r[11]||(r[11]=p("Pick: ")),t("code",Ka,y(c.selectedModel),1)]),t("span",Wa,[r[12]||(r[12]=p("Prediction: ")),t("code",Ha,y(c.selectedMethod),1)])]),t("div",Ga,[n($,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:z=>ce(c),style:{"margin-top":"1rem"}},{default:w(()=>[n(C,{icon:"plus"}),p(" Import "+y(c.name),1)]),_:2},1032,["onClick"]),n($,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:z=>lt(c),style:{"margin-top":"1rem"}},{default:w(()=>[n(C,{icon:"copy"}),r[13]||(r[13]=p(" Copy Share Link "))]),_:2},1032,["onClick"]),n($,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:r[5]||(r[5]=z=>x.value=!x.value),style:{"margin-top":"1rem",background:"red"}},{default:w(()=>[n(C,{icon:"trash"}),r[14]||(r[14]=p(" Delete "))]),_:1})])])]))),128))],64)):(o(),i("div",Qa,[t("span",Ja,[n(C,{icon:"inbox"})]),r[16]||(r[16]=t("h5",{style:{padding:"0",margin:"0"}},"No Snapshot(s) Found!",-1)),r[17]||(r[17]=t("p",{style:{padding:"0",margin:"0","text-align":"center"}},[p("To add a new Snapshot, select Normal & Drop(s) on active Leak Detection chart and click "),t("b",null,"Create Snapshot")],-1))]))])])):M("",!0),I.value?(o(),J(Ca,{key:1,"initial-dates":ke.value,onOnClose:at,onOnApply:he},null,8,["initial-dates"])):M("",!0)],64)}}}),uo=ut(Xa,[["__scopeId","data-v-5f821b1d"]]);export{uo as default};
