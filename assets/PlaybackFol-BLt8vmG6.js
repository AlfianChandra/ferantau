import{u as vt}from"./theme-Vj0dpKBb.js";import{_ as Ot}from"./MainWrapperView.vue_vue_type_style_index_0_lang-Cu-4RgnE.js";import{_ as be}from"./SelectView.vue_vue_type_style_index_0_lang-DsncPw07.js";import{_ as fe}from"./InputView.vue_vue_type_style_index_0_lang-DOwyJqFa.js";import{_ as $}from"./ButtonView.vue_vue_type_style_index_0_computed_true_lang-CbkbXQRv.js";import{_ as Lt,t as et,a as Tt,u as _t,L as Vt}from"./LoadingView-COPKJ4ou.js";import{d as tt,h as r,i as lt,k as F,r as Ge,o,c as i,a as n,w as x,b as re,l as S,g as ct,L as At,e as t,p as v,n as X,u as h,x as Ve,K as Ae,t as m,f as Y,F as P,y as U,_ as ft,m as Ft}from"./index-CeoqUWRv.js";import{a as We}from"./axios-BimPEqV4.js";import{i as Nt}from"./index-CehbAW_K.js";import{h as B}from"./moment-C5S46NFB.js";const Et={style:{width:"100%",display:"flex","flex-flow":"column"}},zt=tt({__name:"PressureDistView",props:{selectedSpot:{type:String,required:!0},data:{type:Object,required:!0},leakPointResult:Object},setup(Fe){const ue=r(!1),R=Fe,de=r(et().getAllTrunk()),A=r({}),y=r(R.selectedSpot),z=()=>de.value[y.value].trunkLength,M=r(0),L=I=>{M.value=I};return lt(()=>{console.log("DATA changed",R.data),ue.value=!0,A.value=R.data,ue.value=!1}),F(()=>R.data,I=>{console.log("DATA changed",R.data),ue.value=!0,A.value=R.data,ue.value=!1},{deep:!0}),(I,K)=>{const g=Ge("center");return o(),i("div",Et,[n(g,null,{default:x(()=>[n(fe,{"in-label":"Drop Tolerance Value","in-type":"number","model-value":M.value,"onUpdate:modelValue":K[0]||(K[0]=Z=>M.value=Z),style:{width:"200px"}},null,8,["model-value"])]),_:1}),!ue.value&&Object.keys(A.value).length?(o(),re(Lt,{key:0,onOnToleranceChanged:L,"chart-data":A.value,"selected-spot":y.value,"trunk-length":z(),"tolerance-value":M.value,"prediction-result":R.leakPointResult},null,8,["chart-data","selected-spot","trunk-length","tolerance-value","prediction-result"])):S("",!0)])}}}),Yt={key:0,class:"datepickdialog"},Rt={class:"datepickinner"},It={style:{display:"flex","flex-flow":"row nowrap",gap:"0.2rem"}},jt={key:1,class:"selfnavdialog"},Ut={class:"selfnavdialog-inner"},qt={style:{display:"flex","flex-flow":"row nowrap","justify-content":"center","margin-bottom":"1rem",gap:"1rem"}},Bt={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem","justify-content":"space-between"}},Kt={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},Wt={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem",height:"45px","align-items":"center"}},Gt={style:{"border-radius":"10px",display:"flex","flex-flow":"row nowrap","justify-content":"space-between","padding-left":"10px","padding-right":"10px",border:"1px solid #ccc",padding:"20px","margin-bottom":"1rem"}},Ht={style:{border:"1px solid #ccc",padding:"5px","padding-left":"70px","text-align":"center","padding-right":"70px","border-radius":"100px"}},Qt={key:0,style:{"font-size":"11px"}},Jt={key:0,style:{"font-size":"11px"}},Xt={key:1,style:{"font-size":"11px"}},Zt={style:{display:"flex","flex-flow":"row nowrap",width:"100%","align-items":"center","margin-top":"-40px"}},el={style:{display:"flex","flex-flow":"no wrap",padding:"10px",gap:"0.5rem"}},tl={style:{width:"100%",padding:"10px",position:"relative"}},ll=["max","value"],al={key:0,class:"sel-wrapper"},ol={style:{display:"flex","justify-content":"flex-start","overflow-x":"auto","white-space":"nowrap",padding:"20px",gap:"1rem",width:"40%"}},sl=["onClick"],nl={key:0,class:"dataspan"},il={style:{width:"50%"}},rl={style:{color:"#fff",background:"red",width:"70px",padding:"5px","border-radius":"5px","font-size":"10px","text-align":"center"}},ul={style:{width:"60%","padding-right":"5rem","padding-top":"1rem","padding-bottom":"1rem"}},dl={class:"table-responsive"},pl={style:{"margin-top":"1rem"}},vl={class:"tbl2"},cl={style:{"margin-top":"1rem"}},fl={class:"tbl2"},yl={key:2,class:"hmloader"},ml={key:3,class:"model-window"},bl={class:"modelpick-inner"},gl={key:4,class:"predict-action"},kl={style:{"margin-bottom":"0.1rem"}},wl={style:{"margin-bottom":"0.5rem"}},hl={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem"}},xl={key:5,class:"leak-window"},Dl={style:{color:"rgb(0,150,255)"}},Sl={class:"table-responsive"},Cl={style:{width:"100%","margin-top":"1rem"},class:"table table-striped table-hover;"},$l={key:0,style:{border:"1px solid #ccc",padding:"10px"}},Ml={key:1,style:{border:"1px solid #ccc",padding:"10px"}},Pl={style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Ol={key:0,style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Ll={key:1,style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},Tl={key:0},_l=["href"],Vl={style:{"margin-top":"1rem"}},Al={key:1},Fl={style:{"margin-top":"1rem"}},Nl={key:6,class:"setting-window"},El={class:"setting-inner"},zl={class:"pref-block"},Yl={key:7,class:"save-window"},Rl={class:"save-inner"},Il={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem"}},jl=tt({__name:"PlaybackView",props:{initDateFilter:{type:String,required:!0},selectedSpot:{type:String,required:!0},initPlaybackDatas:{type:Array,required:!0},snapShots:{type:Object,required:!1,default:null},mainSize:{type:Object,required:!1}},emits:["onDateChange","onDataSave","onLoadPreset"],setup(Fe,{emit:ue}){const R=_t(),de=et(),A=ue,y=vt(),z=r("forward"),M=r(!1),L=r(""),I=r(!0),K=r(!1),g=Fe,Z=r(),p=r(),G=r(de.getAllTrunk()),T=r(0),Ce=r(0),ge=r([]),ke=r(!1),ee=r(250);let H=null;const we=r(!1);let le=[];const he={},He=r(),ae=r(""),xe=r(""),J=r(!0),q=r(!1),b=r(!1),ye=r(!1),me=r(!1),ve=r(!1),Q=r(7),Qe=ct();r(Qe.params.saveid);let d=r({}),u=null;const C=r(null),f=r({}),O=()=>{p.value=Nt(Z.value);const a={grid:{top:"10%",left:"10%",right:"10%",bottom:"15%"},legend:{show:!0,type:"scroll",orient:"horizontal"},tooltip:{trigger:"item",triggerOn:"mousemove",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},axisPointer:{show:!0,type:"shadow"},xAxis:[{type:"category",data:[],boundaryGap:!1,splitNumber:1,minInterval:1,scale:!0,axisLabel:{formatter:function(e){return e.split(" (")[1].split(")")[0]},rotate:45,labelStyle:{fontSize:10}},splitLine:{show:!0,lineStyle:{type:"dashed"}},axisTick:{alignWithLabel:!0}}],yAxis:{type:"value",name:"Pressure (PSI)",nameGap:10,max:600,interval:50,axisTick:{show:!0,inside:!0},splitLine:{show:!0,lineStyle:{type:"solid",color:"#999"}},minorTick:{show:!0},minorSplitLine:{show:!0,lineStyle:{type:"dashed",color:"#ccc"}}},series:[]};p.value.setOption(a),setTimeout(()=>{p.value.dispatchAction({type:"legendInverseSelect"}),p.value.dispatchAction({type:"legendAllSelect"}),p.value.resize()},100)},V=()=>{const a=B().format("YYYY-MM-DD"),e=B(g.initDateFilter).format("YYYY-MM-DD");we.value=a===e};lt(()=>{window.addEventListener("keyup",bt),V()}),F(()=>Z.value,()=>{O(),_(T.value)}),F(()=>g.initPlaybackDatas,(a,e)=>{console.log("mPlayback",g.initPlaybackDatas,"props.snapShots",g.snapShots),!(!a||a.length===0)&&(V(),j(),_(T.value),ke.value=!1,q.value&&(b.value=!0))});const _=a=>{le=[];for(let l of G.value[g.selectedSpot].spot)he[l.name]=[];g.initPlaybackDatas.slice(0,a+1).forEach((l,c)=>{const w=`${l.dateFilter} (${l.timeRange})`;le.push(w),He.value=w,l.data.forEach(E=>{const qe=G.value[g.selectedSpot].spot.find(Ke=>Ke.id===E.idSpot).name,Be=E.avgPsiValues??0;he[qe][c]=Number(Be.toFixed(2))})});const s=Object.keys(he).map(l=>({name:l,type:"line",data:he[l],showAllSymbol:ve.value,smooth:!1,tooltip:{trigger:"axis",formatter:function(c){return c[0].value}},endLabel:{show:!0,formatter:function(c){return c.value+" ; "+l},color:"#000",backgroundColor:"inherit",padding:5,fontSize:10,borderRadius:5}}));let D=p.value.getOption();D.xAxis[0].data=le,D.series=s,p.value.setOption(D)},oe=()=>{p.value.getOption()},j=()=>{b.value=!1,T.value=0,ge.value=[],clearInterval(H),_(T.value),Ce.value=T.value/g.initPlaybackDatas.length*100},Ne=a=>{b.value=!1,ge.value=[],T.value=parseInt(a.target.value,10),_(T.value),Ce.value=T.value/g.initPlaybackDatas.length*100};F(()=>g.initDateFilter,async()=>{Xe(),Je(),await $e().then(()=>{at()})});const at=()=>{const a=B(g.initDateFilter),e=a.add(1,"days").format("YYYY-MM-DD"),s=a.subtract(2,"days").format("YYYY-MM-DD");ae.value=e,xe.value=s};at();const Ee=async()=>{Xe(),await $e().then(()=>{if(we.value)y.notifyShowError("End of playback");else{ye.value=!0,j();const a=B(ae.value).format("YYYY-MM-DD");q.value&&(b.value=!0),ke.value=!0,A("onDateChange",a),setTimeout(()=>{ye.value=!1},5e3)}})},ze=async()=>{Xe(),await $e().then(()=>{ye.value=!0,j();const a=B(xe.value).format("YYYY-MM-DD");q.value&&(b.value=!0),ke.value=!0,A("onDateChange",a),setTimeout(()=>{ye.value=!1},5e3)})};F(()=>J.value,()=>{J.value&&(Pe(),M.value=!1,q.value=!1)}),F(()=>M.value,()=>{M.value?(J.value=!1,q.value=!0):J.value=!0}),F(()=>q.value,()=>{q.value&&(J.value=!1)}),F(()=>b.value,()=>{if(!b.value&&T.value==g.initPlaybackDatas.length)if(J.value)j(),b.value=!0;else{const a=B().format("YYYY-MM-DD"),e=B(g.initDateFilter).format("YYYY-MM-DD");a===e?b.value=!1:M.value?z.value=="forward"?se.value?g.initDateFilter!=ne.value?Ee():Re.value?(j(),A("onDateChange",pe.value)):Pe():Ee():se.value?g.initDateFilter!=pe.value?ze():Re.value?(j(),A("onDateChange",ne.value)):Pe():ze():(j(),b.value=!0)}W.value&&N.value?(st(),ot(),oe()):Ye()});const ot=()=>{if(b.value)Ye();else{const a=p.value.getOption();a.series.forEach(s=>{s.symbolSize=Q.value}),a.series.forEach(s=>{s.symbol="circle"});const e=p.value.getOption().tooltip;e.show=!0,p.value.setOption(a)}},Ye=()=>{const a=p.value.getOption();a.series.forEach(e=>{e.symbolSize=0}),a.series.forEach(e=>{e.symbol="none"}),p.value.setOption(a),p.value.off("click")},k=r({}),st=()=>{p.value.off("click"),p.value.on("click",a=>{if(a.componentType==="markLine"){if(a.seriesName==="Normal"){y.notifyConfirm("Delete Normal","Are you sure?","Delete","Cancel",async()=>{nt()},()=>{});return}else y.notifyConfirm("Delete Marker","Delete this marker?","Delete","Cancel",async()=>{const c=p.value.getOption();c.series=c.series.filter((w,E)=>E!==a.seriesIndex),p.value.clear(),p.value.setOption(c),Object.keys(k.value).forEach(w=>{k.value[w].index===a.value&&delete k.value[w]}),I.value=!1,setTimeout(()=>{I.value=!0},100)},()=>{});return}const e=le.findIndex(c=>c===a.name);if(e<0)return;if(k.value.normal){const c=Object.keys(k.value).length,w={type:"line",name:`Drop ${c}`,xAxisIndex:0,data:[],markLine:{symbol:"image://https://gpng.net/wp-content/uploads/ROBBER.png",symbolSize:35,data:[{xAxis:e,symbolRotate:180}],lineStyle:{color:"blue",width:2,type:"dotted"},label:{show:!0,formatter:`Drop ${c}`,position:"insideEndTop"}}},E=p.value.getOption().series;E.push(w),p.value.setOption({series:E})}else{const c={type:"line",name:"Normal",xAxisIndex:0,data:[],markLine:{symbol:"image://https://png.pngtree.com/png-clipart/20230325/original/pngtree-petroleum-workers-or-miners-vector-png-image_9004441.png",symbolSize:42,data:[{xAxis:e}],lineStyle:{color:"red",width:2,type:"dotted"},label:{show:!0,formatter:"Normal",position:"insideEndTop"}}},w=p.value.getOption().series;w.push(c),p.value.setOption({series:w})}const l=p.value.getOption().series.filter(c=>Array.isArray(c.data)).map(c=>({seriesName:c.name,yValue:c.data[e]??0}));if(k.value.normal){const c=Object.keys(k.value).length;k.value[`drop${c}`]={index:e,name:`Drop ${c}`,data:l,order:p.value.getOption().series.length-1,type:"drop",timerange:le[e].split(" (")[1].split(")")[0],seriesName:le[e].split(" (")[1].split(")")[0]+".drop."+g.initDateFilter,date:g.initDateFilter}}else{const c={normal:{index:e,name:"Normal",data:l,order:0,type:"normal",timerange:le[e].split(" (")[1].split(")")[0],seriesName:le[e].split(" (")[1].split(")")[0]+".normal."+g.initDateFilter,date:g.initDateFilter}};k.value={...c,...k.value},C.value=c.normal.seriesName}})},nt=()=>{const a=p.value.getOption();a.series=a.series.filter(e=>e.name!=="Normal"),p.value.clear(),p.value.setOption(a),delete k.value.normal,y.notifyShow("Normal deleted"),C.value=null},$e=()=>new Promise((a,e)=>{try{if(Object.keys(k.value).length===0){a();return}const s=p.value.getOption();s.series=s.series.filter(D=>!D.markLine),p.value.clear(),p.value.setOption(s),k.value={},a()}catch(s){e(s)}});F(()=>[b.value,ee.value],()=>{b.value?(H!=null&&clearInterval(H),H=setInterval(()=>{T.value<g.initPlaybackDatas.length?(T.value++,g.initPlaybackDatas[T.value]!=null&&(_(T.value),Ce.value=T.value/g.initPlaybackDatas.length*100)):(b.value=!1,clearInterval(H))},ee.value)):H&&(clearInterval(H),H=null)}),F(()=>[y.asideVisible],()=>{setTimeout(()=>{p.value.resize()},1e3)});const Me=r(!1),yt=()=>z.value=="forward"?ae.value:xe.value,ce=r(!1),se=r(!1),Re=r(!0),pe=r(""),ne=r(""),mt=()=>{pe.value?ne.value?(se.value=!0,J.value=!1,M.value=!0,q.value=!0,ce.value=!1,b.value=!1):y.notifyShowError("Date 2 is required"):y.notifyShowError("Date 1 is required")};F(()=>ce.value,()=>{ce.value?(b.value=!1,se.value=!1):b.value=!0}),F(()=>[se.value],()=>{se.value&&(j(),z.value=="forward"?A("onDateChange",pe.value):A("onDateChange",ne.value))}),F(()=>z.value,()=>{z.value=="backward"&&(j(),Pe())});const Pe=()=>{j(),A("onDateChange",g.initDateFilter),se.value=!1,pe.value=null,ne.value=null},bt=a=>{K.value||((a.keyCode==80||a.keyCode==32)&&(b.value=!b.value),a.keyCode==37&&ze(),a.keyCode==39&&Ee())},gt=(a,e)=>{if(a.type=="normal"){y.notifyConfirm("Delete Normal","Are you sure?","Delete","Cancel",async()=>{nt()},()=>{});return}const s=p.value.getOption();s.series=s.series.filter(D=>D.name!==a.name),p.value.clear(),p.value.setOption(s),delete k.value[e],I.value=!1,setTimeout(()=>{I.value=!0},100)},W=r(null),N=r(null),ie=r(!1),kt=()=>{W.value=null,N.value=null,ie.value=!1},Je=()=>{W.value=null,N.value=null,ie.value=!1,Ye(),y.notifyShow("Prediction stopped"),$e(),k.value={}};F(()=>[W.value,N.value],()=>{W.value&&N.value?(st(),ot()):Ye()});const Oe=r(!1),it=r([]),te=r([]),De=r(!1),Ie=r(),wt=r(),ht=()=>{if(!W.value||!N.value){y.notifyShowError("Please select model and method");return}y.notifyShow("Prediction started"),ie.value=!1;let a={};Object.keys(k.value).forEach(s=>{if(k.value[s].type!=="normal"||k.value[s].type!=="drop"){const D=de.getAllTrunk().trunk1.spot.length;let l={name:k.value[s].name,data:k.value[s].data.map(c=>({avgPsiValues:c.yValue})).slice(0,D),type:k.value[s].type};a[k.value[s].name]=l}}),it.value=[];const e=R.mlpredict(a,N.value);if(Oe.value=!0,N.value==="dtree_multi"?setTimeout(()=>{te.value=e.sort((s,D)=>s.drop-D.drop)},4e3):N.value==="rf_multi"?setTimeout(()=>{te.value=e.sort((s,D)=>s.drop-D.drop)},4e3):N.value==="rf_single"?setTimeout(()=>{te.value=e.sort((s,D)=>s.drop-D.drop)},4e3):N.value==="eqlr_single"&&setTimeout(()=>{te.value=e.sort((s,D)=>s.drop-D.drop)},4e3),te.value!=null)for(let s=0;s<te.value.length;s++)te.value[s].suspectLocation.leak&&it.value.push(te.value[s])},rt=r(),ut=r(),xt=(a,e,s)=>{Ie.value=a,De.value=!1,De.value=!0,rt.value=e,ut.value=s};F(()=>Oe.value,()=>{Oe.value||(De.value=!1,te.value=null,Ie.value=null,wt.value=null)});const Dt=async a=>{L.value=a,await navigator.clipboard.writeText(L.value),y.notifyShow("Coordinate copied to clipboard")},je=a=>{const e=Math.floor(a),s=Math.abs(a-e)*60,D=Math.floor(s),l=(s-D)*60;return`${e}° ${D}' ${l.toFixed(2)}"`};F(()=>ve.value,()=>{if(ve.value){Q.value=5;const a=p.value.getOption();a.series.forEach(e=>{e.showAllSymbol=!0}),a.series.forEach(e=>{e.symbolSize=Q.value}),p.value.setOption(a)}else{Q.value=7;const a=p.value.getOption();a.series.forEach(e=>{e.showAllSymbol=!1}),a.series.forEach(e=>{e.symbolSize=Q.value}),p.value.setOption(a)}}),F(()=>Q.value,()=>{const a=p.value.getOption();a.series.forEach(e=>{e.symbolSize=Q.value}),p.value.setOption(a)});const Xe=()=>{Q.value=7,ve.value=!1;const a=p.value.getOption();a.series.forEach(e=>{e.symbolSize=Q.value,e.showAllSymbol=!1}),p.value.setOption(a)},Se=r(!1);F(()=>k.value,()=>{d.value={},Object.keys(k.value).forEach(a=>{const e=k.value[a].seriesName,s=k.value[a].data,l=s.map(c=>{const w=de.getAllTrunk().trunk1.spot.find(E=>E.name===c.seriesName);if(w!==void 0)return w.id}).filter(c=>c!==void 0);d.value[e]===void 0&&(d.value[e]=[]),l.length>0&&(d.value[e]={date:k.value[a].date,timerange:k.value[a].timerange,type:k.value[a].type,data:l.map((c,w)=>({idSpot:c,avgPsiValues:s[w].yValue}))})})});const dt=(a,e)=>{const D=d.value[a].data;for(let l=0;l<D.length;l++)if(D[l].idSpot==e)return D[l].avgPsiValues.toFixed(2)};F(()=>d.value,()=>{var a;if(d.value!=null&&(u=Object.keys(d.value),C.value!=null)){f.value=[];const e=C.value,s=(a=d.value[e])==null?void 0:a.data;u.filter(l=>l!==e).forEach(l=>{const c=d.value[l].data,w=[];G.value.trunk1.spot.forEach((E,qe)=>{const Be=E.id,Ke=s.find(_e=>_e.idSpot===Be),pt=c.find(_e=>_e.idSpot===Be);if(Ke&&pt){const _e=Ke.avgPsiValues.toFixed(2)-pt.avgPsiValues.toFixed(2);w[qe]=_e}else w[qe]=0}),f.value.push({dropKey:l,deltas:w})})}});const Ze=a=>a.spot,Ue=r(!1),Le=r(""),Te=r(""),St=()=>{b.value=!1,Ue.value=!0,K.value=!0},Ct=()=>{Ue.value=!1,K.value=!1},$t=()=>{if(Le.value==""||Te.value==""){y.notifyShowError("Name and description are required");return}y.notifyShow("Saving preset. Please wait..."),Ue.value=!1;const a={name:Le.value,desc:Te.value,selectedModel:W.value,selectedMethod:N.value,selections:k.value,seekerValue:T.value};A("onDataSave",a),Le.value="",Te.value=""},Mt=()=>{A("onLoadPreset")},Pt=()=>{y.notifyShow("Snapshot loaded"),W.value=g.snapShots.selectedModel,N.value=g.snapShots.selectedMethod,setTimeout(()=>{T.value=g.snapShots.seekerValue,setTimeout(()=>{k.value=g.snapShots.selection;const a=p.value.getOption().series;Object.keys(k.value).forEach(s=>{const D=k.value[s];D.type==="normal"?(a.push({type:"line",name:"Normal",xAxisIndex:0,data:[],markLine:{symbol:"image://https://png.pngtree.com/png-clipart/20230325/original/pngtree-petroleum-workers-or-miners-vector-png-image_9004441.png",symbolSize:42,data:[{xAxis:D.index}],lineStyle:{color:"red",width:2,type:"dotted"},label:{show:!0,formatter:"Normal",position:"insideEndTop"}}}),C.value=D.seriesName):a.push({type:"line",name:D.name,xAxisIndex:0,data:[],markLine:{symbol:"image://https://gpng.net/wp-content/uploads/ROBBER.png",symbolSize:35,data:[{xAxis:D.index,symbolRotate:180}],lineStyle:{color:"blue",width:2,type:"dotted"},label:{show:!0,formatter:D.name,position:"insideEndTop"}}})}),p.value.setOption({series:a});const e=p.value.getOption();p.value.clear(),p.value.setOption(e)},1e3),_(T.value)},3e3)};return At(()=>{p.value&&g.snapShots&&Object.keys(g.snapShots).length>0&&Pt()}),(a,e)=>{const s=Ge("font-awesome-icon"),D=Ge("center");return o(),i(P,null,[ce.value?(o(),i("div",Yt,[t("div",Rt,[e[32]||(e[32]=t("h2",null,[t("b",null,"Select Range")],-1)),e[33]||(e[33]=t("p",{style:{padding:"0",margin:"0"}},"Automatically plays the playback based on current setup",-1)),n(be,{"in-label":"Speed","model-value":ee.value,"onUpdate:modelValue":e[0]||(e[0]=l=>ee.value=l)},{default:x(()=>e[29]||(e[29]=[t("option",{value:"1000"},"Slowest",-1),t("option",{value:"500"},"Slower",-1),t("option",{value:"300"},"Moderate",-1),t("option",{value:"250"},"Faster",-1),t("option",{value:"200"},"Fastest",-1)])),_:1},8,["model-value"]),n(fe,{"in-type":"date","in-label":"Date 1","model-value":pe.value,"onUpdate:modelValue":e[1]||(e[1]=l=>pe.value=l)},null,8,["model-value"]),n(fe,{"in-type":"date","in-label":"Date 2","model-value":ne.value,"onUpdate:modelValue":e[2]||(e[2]=l=>ne.value=l)},null,8,["model-value"]),t("div",It,[n($,{onClick:mt,"bt-disabled":!1,style:{width:"fit-content"}},{default:x(()=>e[30]||(e[30]=[v("Apply Filter")])),_:1}),n($,{onClick:e[3]||(e[3]=l=>ce.value=!ce.value),"bt-disabled":!1,style:{width:"fit-content"}},{default:x(()=>e[31]||(e[31]=[v("Cancel ")])),_:1})])])])):S("",!0),Me.value?(o(),i("div",jt,[t("div",Ut,[e[36]||(e[36]=t("h2",null,[t("b",null,"Select Preference")],-1)),n(be,{"in-label":"Select","model-value":z.value,"onUpdate:modelValue":e[4]||(e[4]=l=>z.value=l)},{default:x(()=>e[34]||(e[34]=[t("option",{value:"forward"},"Forward",-1),t("option",{value:"backward"},"Backward",-1)])),_:1},8,["model-value"]),n($,{onClick:e[5]||(e[5]=l=>Me.value=!Me.value),style:{width:"fit-content"},"bt-disabled":!1},{default:x(()=>[n(s,{icon:"save"}),e[35]||(e[35]=v(" Save & Apply"))]),_:1})])])):S("",!0),e[93]||(e[93]=t("h5",{style:{"text-align":"center"}},[t("b",null,"Playback")],-1)),n(D,null,{default:x(()=>[n(be,{style:{width:"400px"},"in-label":"Speed","model-value":ee.value,"onUpdate:modelValue":e[6]||(e[6]=l=>ee.value=l)},{default:x(()=>e[37]||(e[37]=[t("option",{value:"1000"},"Slowest",-1),t("option",{value:"500"},"Slower",-1),t("option",{value:"300"},"Moderate",-1),t("option",{value:"250"},"Faster",-1),t("option",{value:"200"},"Fastest",-1)])),_:1},8,["model-value"])]),_:1}),t("div",qt,[!b.value&&!N.value&&!W.value?(o(),re($,{key:0,onClick:e[7]||(e[7]=l=>ie.value=!ie.value),"bt-disabled":!1},{default:x(()=>[n(s,{icon:"atom"}),e[38]||(e[38]=v(" Leak Detection"))]),_:1})):S("",!0),b.value?S("",!0):(o(),re($,{key:1,onClick:Mt,"bt-disabled":!1},{default:x(()=>[n(s,{icon:"download"}),e[39]||(e[39]=v(" Import Snapshot "))]),_:1})),N.value&&W.value?(o(),re($,{key:2,onClick:e[8]||(e[8]=l=>me.value=!me.value),"bt-disabled":!1},{default:x(()=>[n(s,{icon:"sliders"}),e[40]||(e[40]=v(" Settings "))]),_:1})):S("",!0),N.value&&W.value?(o(),re($,{key:3,style:{background:"red"},onClick:Je,"bt-disabled":!1},{default:x(()=>[n(s,{icon:"close"}),e[41]||(e[41]=v(" Quit Prediction"))]),_:1})):S("",!0)]),t("div",Bt,[t("div",Kt,[t("label",{class:X([`${h(y).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Ve(t("input",{"onUpdate:modelValue":e[9]||(e[9]=l=>J.value=l),type:"checkbox"},null,512),[[Ae,J.value]]),e[42]||(e[42]=v(" Auto-replay "))],2),t("label",{class:X([`${h(y).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Ve(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>q.value=l),type:"checkbox"},null,512),[[Ae,q.value]]),e[43]||(e[43]=v(" Autoplay on navigating "))],2),t("label",{class:X([`${h(y).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},[Ve(t("input",{"onUpdate:modelValue":e[11]||(e[11]=l=>M.value=l),type:"checkbox"},null,512),[[Ae,M.value]]),e[44]||(e[44]=v(" Self Navigate "))],2),M.value?(o(),re($,{key:0,onClick:e[12]||(e[12]=l=>Me.value=!Me.value),"bt-disabled":!1,type:"button",class:"slfnavbtn"},{default:x(()=>[n(s,{icon:"sliders"})]),_:1})):S("",!0)]),t("div",Wt,[se.value?(o(),i("label",{key:0,class:X([`${h(y).textTheme}`]),style:{border:"1px solid #ccc",padding:"10px","border-radius":"10px"}},[v(m(h(B)(pe.value).format("ddd, DD MMM YY"))+"    ",1),n(s,{icon:z.value=="forward"?"caret-right":"caret-left"},null,8,["icon"]),v("    "+m(h(B)(ne.value).format("ddd, DD MMM YY")),1)],2)):S("",!0),se.value?(o(),i("label",{key:1,class:X([`${h(y).textTheme}`]),style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","border-radius":"10px"}},[Ve(t("input",{"onUpdate:modelValue":e[13]||(e[13]=l=>Re.value=l),type:"checkbox"},null,512),[[Ae,Re.value]]),e[45]||(e[45]=v(" Repeat "))],2)):S("",!0),n($,{onClick:e[14]||(e[14]=l=>ce.value=!ce.value),"bt-disabled":!1,type:"button",class:"slfnavbtn"},{default:x(()=>[n(s,{icon:"calendar"})]),_:1}),pe.value&&ne.value?(o(),re($,{key:2,onClick:Pe,"bt-disabled":!1,class:"slfnavbtn"},{default:x(()=>[n(s,{icon:"close"})]),_:1})):S("",!0)])]),t("div",Gt,[n($,{"bt-disabled":ye.value,onClick:ze},{default:x(()=>[n(s,{icon:"backward"}),v("    "+m(h(B)(xe.value).format("ddd, DD MMM YY")),1)]),_:1},8,["bt-disabled"]),t("span",Ht,[t("b",{style:Y({color:`${h(y).accentColor}`})},m(h(B)(g.initDateFilter).format("ddd, DD MMM YY")),5),e[49]||(e[49]=t("br",null,null,-1)),se.value?(o(),i("span",{key:0,class:X([`${h(y).textTheme}`]),style:{"font-size":"11px"}},[e[46]||(e[46]=v("Stops at: ")),t("b",null,m(h(B)(ne.value).format("ddd, DD MMM YY")),1)],2)):(o(),i(P,{key:1},[J.value?(o(),i("span",Qt,[e[47]||(e[47]=v("Repeating: ")),t("b",null,m(h(B)(g.initDateFilter).format("ddd, DD MMM YY")),1)])):(o(),i(P,{key:1},[we.value?(o(),i("span",Xt,"[End of playback  ·  Autoplay stopped]")):(o(),i("span",Jt,[e[48]||(e[48]=v("Upcoming: ")),t("b",null,m(h(B)(yt()).format("ddd, DD MMM YY")),1)]))],64))],64))]),n($,{"bt-disabled":we.value,onClick:Ee},{default:x(()=>[v(m(h(B)(ae.value).format("ddd, DD MMM YY"))+"    ",1),n(s,{icon:"forward"})]),_:1},8,["bt-disabled"])]),t("div",{style:Y([{position:"relative",width:"100%"},{marginBottom:Object.keys(k.value).length>1?"8rem":"0"}])},[t("div",{ref_key:"heatMap",ref:Z,style:{width:"100%",height:"600px"}},null,512),t("div",Zt,[t("div",el,[b.value?S("",!0):(o(),i("button",{key:0,style:{"z-index":"1",position:"relative"},onClick:e[15]||(e[15]=l=>b.value=!b.value),class:"controlbtn",type:"button"},[n(s,{icon:"play"})])),b.value?(o(),i("button",{key:1,style:{"z-index":"1",position:"relative"},onClick:e[16]||(e[16]=l=>b.value=!b.value),class:"controlbtn",type:"button"},[n(s,{icon:"pause"})])):S("",!0)]),t("div",tl,[t("input",{onChange:Ne,type:"range",min:0,max:g.initPlaybackDatas.length,value:T.value,class:"slider"},null,40,ll)]),t("div",null,[!b.value&&T.value==g.initPlaybackDatas.length?(o(),i("button",{key:0,onClick:j,class:"controlbtn",type:"button"},[n(s,{icon:"undo"})])):S("",!0)])]),Object.keys(k.value).length?(o(),i("div",al,[t("div",ol,[(o(!0),i(P,null,U(k.value,(l,c)=>(o(),i("div",{key:c,class:"selection-item",onClick:w=>gt(l,c)},[t("h5",{style:Y({color:l.type=="normal"?"red":"blue"})},[t("b",null,m(l.name),1)],4),(o(!0),i(P,null,U(l.data,w=>(o(),i("div",{key:w.seriesName},[w.seriesName!="Normal"&&!w.seriesName.includes("Drop")?(o(),i("span",nl,[t("span",il,m(w.seriesName),1),e[50]||(e[50]=v()),t("span",rl,[t("b",null,m(w.yValue)+" PSI",1)])])):S("",!0)]))),128))],8,sl))),128))]),t("div",ul,[e[55]||(e[55]=t("h4",{style:{"text-align":"center"}},[t("b",null,"Pressure Distribution")],-1)),I.value?(o(),re(zt,{key:0,style:{width:"100%"},data:h(d),"selected-spot":"trunk1"},null,8,["data"])):S("",!0),e[56]||(e[56]=t("hr",null,null,-1)),t("div",dl,[t("h5",pl,[t("b",null,[n(s,{icon:"oil-well"}),e[51]||(e[51]=v(" Selected Pressures"))])]),t("table",vl,[t("thead",null,[t("tr",{style:{padding:"5px"},class:X([`${h(y).textTheme}`])},[t("th",{style:Y({border:`1px solid ${h(y).accentColor}`})},"ACTION",4),t("th",{style:Y({border:`1px solid ${h(y).accentColor}`})},"PINNED SERIES",4),(o(!0),i(P,null,U(Ze(G.value.trunk1),(l,c)=>(o(),i("th",{style:Y({border:`1px solid ${h(y).accentColor}`}),key:c},m(l.name),5))),128))],2)]),t("tbody",null,[(o(!0),i(P,null,U(h(u),(l,c)=>(o(),i("tr",{key:c},[t("td",{style:Y({border:`1px solid ${h(y).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},null,4),t("td",{class:X([`${h(y).textTheme}`]),style:Y({border:`1px solid ${h(y).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},[v(m(h(d)[l].date),1),e[52]||(e[52]=t("br",null,null,-1)),v(" "+m(h(d)[l].timerange),1),e[53]||(e[53]=t("br",null,null,-1)),v(" "+m(h(d)[l].type),1)],6),(o(!0),i(P,null,U(Ze(G.value.trunk1),(w,E)=>(o(),i("td",{style:Y({border:`1px solid ${h(y).accentColor}`}),class:X([`${h(y).textTheme}`]),key:E},[dt(l,w.id)?(o(),i(P,{key:0},[v(m(dt(l,w.id)),1)],64)):(o(),i(P,{key:1},[v("0.00")],64))],6))),128))]))),128))])]),t("h5",cl,[t("b",null,[n(s,{icon:"turn-down"}),e[54]||(e[54]=v(" Delta"))])]),t("table",fl,[t("thead",null,[t("tr",{style:{padding:"5px"},class:X([`${h(y).textTheme}`])},[t("th",{style:Y({border:`1px solid ${h(y).accentColor}`})},"DROPS",4),t("th",{style:Y({border:`1px solid ${h(y).accentColor}`})},"PINNED SERIES",4),(o(!0),i(P,null,U(Ze(G.value.trunk1),(l,c)=>(o(),i("th",{style:Y({border:`1px solid ${h(y).accentColor}`}),key:c},m(l.name),5))),128))],2)]),t("tbody",null,[(o(!0),i(P,null,U(f.value,(l,c)=>(o(),i("tr",{key:c},[t("td",{style:Y({border:`1px solid ${h(y).accentColor}`})},m(c+1),5),t("td",{style:Y({border:`1px solid ${h(y).accentColor}`})},m(l.dropKey.split(".")[0]+"."+l.dropKey.split(".")[1]+"."+l.dropKey.split(".")[2]),5),(o(!0),i(P,null,U(l.deltas,(w,E)=>(o(),i("td",{key:E,style:Y({border:`1px solid ${h(y).accentColor}`})},m(w.toFixed(2)),5))),128))]))),128))])])])])])):S("",!0)],4),ke.value?(o(),i("div",yl,e[57]||(e[57]=[t("img",{src:"https://cdn.dribbble.com/users/1138184/screenshots/3796132/oil.gif"},null,-1)]))):S("",!0),ie.value?(o(),i("div",ml,[t("div",bl,[t("button",{onClick:kt,class:"modelpick-dismiss"},[n(s,{icon:"times"})]),e[61]||(e[61]=t("h2",null,[t("b",null,"Leak Detection")],-1)),n(be,{"in-label":"Select Model","model-value":W.value,"onUpdate:modelValue":e[17]||(e[17]=l=>W.value=l)},{default:x(()=>e[58]||(e[58]=[t("option",{value:""},"Select...",-1),t("option",{value:"normal_pick"},"Normal Pick",-1),t("option",{value:"ranged_pick"},"Ranged Pick",-1)])),_:1},8,["model-value"]),n(be,{"in-label":"Select Prediction Method","model-value":N.value,"onUpdate:modelValue":e[18]||(e[18]=l=>N.value=l)},{default:x(()=>e[59]||(e[59]=[t("option",{value:""},"Select method...",-1),t("option",{value:"dtree_multi"},"DTree Multi-leak",-1),t("option",{value:"rf_single"},"RF Single-leak",-1),t("option",{value:"rf_multi"},"RF Multi-leak",-1),t("option",{value:"eqlr_single"},"EQ-Based LR Single-leak",-1)])),_:1},8,["model-value"]),n($,{onClick:e[19]||(e[19]=l=>ie.value=!ie.value),style:{width:"fit-content","margin-top":"0.5rem"},"bt-disabled":!1},{default:x(()=>e[60]||(e[60]=[v(" Start Picking")])),_:1})])])):S("",!0),Object.keys(k.value).length>1&&!Se.value?(o(),i("div",gl,[t("button",{type:"button",class:"predict-action-hide",onClick:e[20]||(e[20]=l=>Se.value=!Se.value)},[n(s,{icon:"eye-slash"})]),t("div",kl,[e[62]||(e[62]=v("Picking Model: ")),t("b",null,m(W.value.split("_").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")),1),e[63]||(e[63]=v(" ··· Prediction Method: ")),t("b",null,m(N.value.split("_").map(l=>l.charAt(0).toUpperCase()+l.slice(1)).join(" ")),1)]),t("div",wl,[e[64]||(e[64]=v("Num of drops: ")),t("b",null,m(Object.keys(k.value).filter(l=>k.value[l].type=="drop").length),1)]),t("div",hl,[n($,{"bt-size":"small",onClick:ht,"bt-disabled":!1,style:{width:"fit-content"}},{default:x(()=>[n(s,{icon:"check"}),e[65]||(e[65]=v(" Predict "))]),_:1}),n($,{"bt-size":"small",onClick:St,"bt-disabled":!1,style:{width:"fit-content",background:"rgb(0,150,255)"}},{default:x(()=>[n(s,{icon:"plus"}),e[66]||(e[66]=v(" Create Snapshot "))]),_:1}),n($,{"bt-size":"small",onClick:e[21]||(e[21]=l=>ie.value=!ie.value),"bt-disabled":!1,style:{width:"fit-content",background:"#666"}},{default:x(()=>[n(s,{icon:"refresh"}),e[67]||(e[67]=v(" Change Method "))]),_:1}),n($,{"bt-size":"small",onClick:$e,"bt-disabled":!1,style:{width:"fit-content",background:"orange"}},{default:x(()=>[n(s,{icon:"trash"}),e[68]||(e[68]=v(" Clear Selection "))]),_:1}),n($,{"bt-size":"small",onClick:Je,"bt-disabled":!1,style:{width:"fit-content",background:"red"}},{default:x(()=>[n(s,{icon:"close"}),e[69]||(e[69]=v(" Quit Prediction "))]),_:1})])])):S("",!0),Oe.value?(o(),i("div",xl,[t("div",{class:X(["leak-body",[`${h(y).mTheme}`]])},[t("button",{type:"button",onClick:e[22]||(e[22]=l=>Oe.value=!1),class:"leak-dismiss"},[n(s,{icon:"times"})]),t("div",{class:"l-left",style:Y({width:De.value?"40%":"100%"})},[e[82]||(e[82]=t("h4",{style:{"font-weight":"bold"}},"Leak Analysis",-1)),e[83]||(e[83]=t("hr",null,null,-1)),te.value?(o(!0),i(P,{key:0},U(te.value,(l,c)=>(o(),i("div",{class:"analysis-set",key:c},[l!=!1?(o(),i(P,{key:0},[t("h4",Dl,[t("b",null," DROP "+m(l.drop),1)]),t("p",null,[e[80]||(e[80]=v(" Result: ")),l!=!1&&l.suspectLocation.leak?(o(),i(P,{key:0},[e[78]||(e[78]=t("b",{style:{color:"red"}},"Possible leak detected!",-1)),t("div",Sl,[t("table",Cl,[t("tr",null,[e[70]||(e[70]=t("th",{style:{border:"1px solid #ccc",padding:"10px"}},"Estimated Leak Point",-1)),l.suspectLocation.leakData.pu_location?(o(),i("th",$l," PU ")):S("",!0),l.suspectLocation.leakData.coordinate?(o(),i("th",Ml," Coordinate ")):S("",!0)]),t("tbody",null,[t("tr",null,[t("td",Pl,m(l.suspectLocation.leakData.leak_point)+" KM ",1),l.suspectLocation.leakData.pu_location?(o(),i("td",Ol," KM "+m(l.suspectLocation.leakData.pu_location),1)):S("",!0),l.suspectLocation.leakData.coordinate?(o(),i("td",Ll,[e[72]||(e[72]=v(" LatLng: ")),t("code",null,m(l.suspectLocation.leakData.coordinate.latitude+", "+l.suspectLocation.leakData.coordinate.longitude),1),e[73]||(e[73]=t("br",null,null,-1)),e[74]||(e[74]=v(" DMS: ")),t("code",null,m(`${je(l.suspectLocation.leakData.coordinate.latitude)}, ${je(l.suspectLocation.leakData.coordinate.longitude)}`),1),e[75]||(e[75]=t("br",null,null,-1)),n($,{onClick:w=>Dt(`LATLNG: ${l.suspectLocation.leakData.coordinate.latitude}, ${l.suspectLocation.leakData.coordinate.longitude}
DMS: ${je(l.suspectLocation.leakData.coordinate.latitude)}, ${je(l.suspectLocation.leakData.coordinate.longitude)}`),style:{"margin-top":"5px"},"bt-disabled":!1,"bt-size":"small"},{default:x(()=>[n(s,{icon:"copy"}),e[71]||(e[71]=v(" Copy Coord "))]),_:2},1032,["onClick"])])):S("",!0)])])])]),l.suspectLocation.leakData.coordinate?S("",!0):(o(),i("p",Tl,[n(s,{icon:"info-circle"}),e[76]||(e[76]=v(" Map view and PU Location data is currently not supported for this line "))])),n($,{onClick:w=>xt(l.suspectLocation.leakData.coordinate,l.suspectLocation.leakData.leak_point,l.suspectLocation.leakData.pu_location),"bt-disabled":!l.suspectLocation.leakData.coordinate},{default:x(()=>[n(s,{icon:"map-marker"}),e[77]||(e[77]=v(" Pinpoint on Map"))]),_:2},1032,["onClick","bt-disabled"]),l.suspectLocation.leakData.coordinate?(o(),i("a",{key:1,class:"gmaps",target:"_blank",href:`https://www.google.com/maps?q=${l.suspectLocation.leakData.coordinate.latitude},${l.suspectLocation.leakData.coordinate.longitude}`,style:{"margin-left":"0.5rem"}},"Google Maps",8,_l)):S("",!0)],64)):(o(),i(P,{key:1},[e[79]||(e[79]=t("b",{style:{color:"#555"}},"No leak detected",-1)),t("ol",Vl,[(o(!0),i(P,null,U(l.suspectLocation.probabilities,(w,E)=>(o(),i("li",{key:E},m(w),1))),128))])],64))])],64)):(o(),i("h6",Al,[t("b",null,"Analysis on Dataset "+m(c+1),1),e[81]||(e[81]=t("b",{style:{color:"#555"}},"Tidak ada indikasi",-1)),t("ol",Fl,[(o(!0),i(P,null,U(l.suspectLocation.probabilities,(w,E)=>(o(),i("li",{key:E},m(w),1))),128))])]))]))),128)):(o(),re(Vt,{key:1,message:"Calculating leak probabilities..."}))],4),De.value?(o(),i("div",{key:0,class:"l-right",style:Y({width:De.value?"60%":"100%",position:"relative"})},[e[84]||(e[84]=t("h4",{style:{"font-weight":"bold"}},"Map View",-1)),e[85]||(e[85]=t("hr",null,null,-1)),n(Tt,{latitude:Ie.value.latitude,longitude:Ie.value.longitude,"leak-point":rt.value,"pu-location":ut.value},null,8,["latitude","longitude","leak-point","pu-location"])],4)):S("",!0)],2)])):S("",!0),me.value?(o(),i("div",Nl,[t("div",El,[e[88]||(e[88]=t("h5",null,[t("b",null,"Prediction Mode Preferences")],-1)),e[89]||(e[89]=t("hr",null,null,-1)),n(fe,{"in-label":"Dot Symbol Size","model-value":Q.value,"onUpdate:modelValue":e[23]||(e[23]=l=>Q.value=l),"in-type":"number"},null,8,["model-value"]),t("label",zl,[Ve(t("input",{type:"checkbox","onUpdate:modelValue":e[24]||(e[24]=l=>ve.value=l)},null,512),[[Ae,ve.value]]),e[86]||(e[86]=t("div",{style:{display:"flex","flex-flow":"column","margin-left":"0.7rem"}},[t("span",{style:{"font-size":"13px"}},[t("b",null,"Show all dots")]),t("span",{style:{"font-size":"11px"}},"Show all dots or reduce the dot placement")],-1))]),n($,{onClick:e[25]||(e[25]=l=>me.value=!me.value),style:{width:"fit-content"},"bt-disabled":!1},{default:x(()=>e[87]||(e[87]=[v("Save Preferences")])),_:1})])])):S("",!0),Ue.value?(o(),i("div",Yl,[t("div",Rl,[e[92]||(e[92]=t("h2",null,[t("b",null,"Snapshot")],-1)),n(fe,{"in-label":"Name","model-value":Le.value,"onUpdate:modelValue":e[26]||(e[26]=l=>Le.value=l),"in-type":"text"},null,8,["model-value"]),n(fe,{"in-label":"Description","model-value":Te.value,"onUpdate:modelValue":e[27]||(e[27]=l=>Te.value=l),"in-type":"text"},null,8,["model-value"]),t("div",Il,[n($,{onClick:$t,style:{width:"fit-content"},"bt-disabled":!1},{default:x(()=>[n(s,{icon:"save"}),e[90]||(e[90]=v(" Create "))]),_:1}),n($,{onClick:Ct,style:{width:"fit-content"},"bt-disabled":!1},{default:x(()=>e[91]||(e[91]=[v("Cancel ")])),_:1})])])])):S("",!0),Se.value?(o(),i("button",{key:8,type:"button",onClick:e[28]||(e[28]=l=>Se.value=!Se.value),class:"predict-action-show"},[n(s,{icon:"eye"})])):S("",!0)],64)}}}),Ul=ft(jl,[["__scopeId","data-v-ea177e59"]]),ql={class:"row"},Bl={class:"col-md-3"},Kl=["value"],Wl={style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},Gl={style:{display:"flex","flex-flow":"row nowrap",gap:"1rem","align-items":"center"}},Hl={class:"col-md-12",style:{position:"relative"}},Ql={key:0,class:"loaders"},Jl={key:0,class:"load-window"},Xl={class:"load-inner"},Zl={style:{display:"flex","flex-flow":"column","align-items":"flex-start",gap:"0.2rem"}},ea={style:{margin:"0",padding:"0"}},ta={style:{"font-size":"9px",color:"red"}},la={style:{"font-size":"11px","margin-bottom":"1rem"}},aa={style:{display:"flex","flex-flow":"row wrap","font-size":"11px",gap:"0.2rem",border:"1px solid #ccc",width:"100%",padding:"10px","border-radius":"10px"}},oa={style:{color:"#555",padding:"5px",background:"#ddd","border-radius":"5px"}},sa={style:{display:"flex","flex-flow":"row wrap","font-size":"11px",gap:"0.2rem",border:"1px solid #ccc",width:"100%",padding:"10px","border-radius":"10px"}},na={style:{color:"#555",padding:"10px",background:"#eee","border-radius":"5px","text-align":"center"}},ia={style:{display:"flex","flex-flow":"row wrap","font-size":"12px",background:"#eee",padding:"10px","border-radius":"10px",border:"1px solid #ccc",width:"100%"}},ra={style:{"margin-right":"10px","font-weight":"bold"}},ua={style:{"font-weight":"bold"}},da={style:{"font-weight":"bold"}},pa={style:{"font-weight":"bold"}},va={style:{display:"flex","flex-flow":"row nowrap",gap:"0.3rem"}},ca={key:1,style:{display:"flex","flex-flow":"column","align-items":"center","justify-content":"center",gap:"1rem"}},fa={style:{"font-size":"30px"}},ya=tt({__name:"PlaybackFol",setup(Fe){const ue=et(),R=vt();R.asideToggle(!1);const de=r(ue.getAllTrunk()),A=r("trunk1"),y=r();y.value=Object.keys(de.value);const z=r(5),M=r(),L=r([]),I=r(0),K=r([]),g=r(!1),Z=r(!1),p=r(!1),G=r({}),T=r(!0),Ce=ct(),ge=()=>{I.value++,L.value.push(null)};lt(()=>{setTimeout(async()=>{const d=Ce.params.saveid;if(d){const u="https://rtunode.findingoillosses.com/api/v1/getpresetbyid",C={key:d},f=await We.post(u,C),O=f.data.status,V=f.data.data;if(O===200){const _=V;K.value=[],L.value=[];const oe=_.dates;I.value=0,console.log(oe),z.value=_.timerange,M.value=oe[0];for(let j=1;j<oe.length;j++)ge();setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((j,Ne)=>{j.value=oe[Ne],L.value[Ne]=j}),H(),G.value={name:_.name,desc:_.desc,selectedMethod:_.selectedMethod,selectedModel:_.selectedModel,selection:_.selections,seekerValue:_.seekerValue},g.value=!0},100)}else R.notifyShowError("Failed fetching snapshot!")}else ke(),g.value=!0},2e3)}),F(()=>[M.value,z.value,A.value],async()=>{G.value={},Z.value=!0,await H()});const ke=()=>{const d=new Date,u=d.getFullYear(),C=String(d.getMonth()+1).padStart(2,"0"),f=String(d.getDate()).padStart(2,"0"),O=`${u}-${C}-${f}`;M.value=O},ee=async d=>new Promise(async(u,C)=>{try{const f=de.value[A.value];let O=[];for(let oe=0;oe<f.spot.length;oe++)O.push(f.spot[oe].id);const V={datefilter:d,timeFilter:z.value,idFilter:O},_=await We.post(Ft.baseEnd+"api/History/getsplittedhistdata",V);u(_.data)}catch(f){C(f)}}),H=async()=>{try{p.value=!0;let u=[...await ee(M.value)];if(L.value.length>0){for(let C=0;C<L.value.length;C++){const f=L.value[C];if(f!==null){if(f.value!==M.value){const O=await ee(f.value);u=u.concat(O)}}else console.log("Null")}Z.value=!1}K.value=u,p.value=!1}catch(d){console.log(d),Z.value=!1,p.value=!1}},we=async()=>new Promise(async(d,u)=>{try{p.value=!0;let f=[...await ee(M.value)];if(L.value.length>0){for(let O=0;O<L.value.length;O++){const V=L.value[O];if(V!==null){if(V.value!==M.value){const _=await ee(V.value);f=f.concat(_)}}else console.log("Null")}Z.value=!1}K.value=f,p.value=!1,d(!0)}catch(C){console.log(C),Z.value=!1,p.value=!1,u(!1)}}),le=(d,u)=>{L.value[u]=d,console.log(L.value),H()},he=()=>{I.value>0&&(I.value--,L.value.pop(),console.log(L.value)),H()},He=d=>{M.value=d},ae=r([]),xe=async d=>{J();const u={};u.name=d.name,u.desc=d.desc,u.timerange=z.value,u.selectedModel=d.selectedModel,u.selectedMethod=d.selectedMethod,u.dates=ae.value,u.selections=d.selections,u.seekerValue=d.seekerValue,(await We.post("https://rtunode.findingoillosses.com/api/v1/savepreset",u)).data.status===200?(R.notifyShow("Preset has been saved!"),ae.value=[]):(R.notifyShowError("Failed saving preset!"),ae.value=[])},J=()=>{if(ae.value.push(M.value),L.value.length)for(let d in L.value)ae.value.push(L.value[d].value)},q=r([]),b=r(!1),ye=()=>{b.value=!0,me()},me=async()=>{const d=await We.get("https://rtunode.findingoillosses.com/api/v1/getpresets");d.data.status===200?(q.value=d.data.data,console.log(q.value)):R.notifyShowError("Failed fetching snapshots!")},ve=async d=>{T.value=!1,K.value=null,L.value=[];const u=d.dates;I.value=0,z.value=d.timerange,M.value=u[0];for(let C=1;C<u.length;C++)ge();Q(u).then(async()=>{await we().then(()=>{G.value={name:d.name,desc:d.desc,selectedMethod:d.selectedMethod,selectedModel:d.selectedModel,selection:d.selections,seekerValue:d.seekerValue},console.log("snapShot loaded",G.value),b.value=!1,console.log("PB DATA FETCH BULKED",K.value,"SNAP DATA",G.value),setTimeout(()=>{T.value=!0},1e3)})})},Q=d=>new Promise((u,C)=>{try{setTimeout(()=>{document.querySelectorAll('input[type="date"]').forEach((f,O)=>{f.value=d[O],L.value[O]=f}),u(!0)},50)}catch(f){C(f)}}),Qe=d=>{const u=`https://rantau.findingoillosses.com/fol/playback/${d.key}`;navigator.clipboard.writeText(u).then(()=>{R.notifyShow(`${d.name} -> Link copied. CTRL+V to paste`)}),b.value=!1};return(d,u)=>{const C=Ge("font-awesome-icon");return o(),i(P,null,[n(Ot,{"context-title":"Playback"},{default:x(()=>[t("div",ql,[t("div",Bl,[n(be,{"in-label":"Select Line","model-value":A.value,"onUpdate:modelValue":u[0]||(u[0]=f=>A.value=f)},{default:x(()=>[(o(!0),i(P,null,U(y.value,(f,O)=>(o(),i("option",{key:O,value:f},m(de.value[f].name),9,Kl))),128))]),_:1},8,["model-value"]),n(be,{"in-label":"Time Range","model-value":z.value,"onUpdate:modelValue":u[1]||(u[1]=f=>z.value=f)},{default:x(()=>u[5]||(u[5]=[t("option",{value:"1"},"1 Menit",-1),t("option",{value:"2"},"2 Menit",-1),t("option",{value:"3"},"3 Menit",-1),t("option",{value:"4"},"4 Menit",-1),t("option",{value:"5"},"5 Menit",-1),t("option",{value:"10"},"10 Menit",-1),t("option",{value:"15"},"15 Menit",-1),t("option",{value:"30"},"30 Menit",-1),t("option",{value:"60"},"60 Menit",-1)])),_:1},8,["model-value"]),t("div",Wl,[n(fe,{"in-type":"date","in-label":"Date Filter","model-value":M.value,"onUpdate:modelValue":u[2]||(u[2]=f=>M.value=f),style:{width:"100%"}},null,8,["model-value"])]),t("div",Gl,[n($,{onClick:he,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:x(()=>[n(C,{icon:"minus"})]),_:1}),t("span",{class:X([`${h(R).textTheme}`])},m(I.value),3),n($,{onClick:ge,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:x(()=>[n(C,{icon:"plus"})]),_:1})]),(o(!0),i(P,null,U(I.value,(f,O)=>(o(),i("div",{key:O,style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},[n(fe,{"in-type":"date","in-label":`Date Filter ${f}`,onOnValueChange:V=>le(V,O),style:{width:"100%"}},null,8,["in-label","onOnValueChange"])]))),128))]),t("div",Hl,[p.value&&g.value?(o(),i("div",Ql,u[6]||(u[6]=[t("img",{src:"https://cdn.dribbble.com/users/1138184/screenshots/3796132/oil.gif",style:{width:"350px",height:"350px","object-fit":"contain","border-radius":"20px"}},null,-1)]))):S("",!0),K.value&&T.value?(o(),re(Ul,{key:1,"snap-shots":G.value,onOnDataSave:xe,onOnLoadPreset:ye,"init-date-filter":M.value,"selected-spot":A.value,"init-playback-datas":K.value,onOnDateChange:He},null,8,["snap-shots","init-date-filter","selected-spot","init-playback-datas"])):S("",!0)])])]),_:1}),b.value?(o(),i("div",Jl,[t("div",Xl,[t("button",{type:"button",class:"load-dismiss",onClick:u[3]||(u[3]=f=>b.value=!b.value)},[n(C,{icon:"times"})]),q.value.length>0?(o(),i(P,{key:0},[u[12]||(u[12]=t("h2",{style:{"padding-left":"1rem"}},[t("b",null,"Saved Snapshots")],-1)),(o(!0),i(P,null,U(q.value,(f,O)=>(o(),i("div",{class:"preset-item",key:O},[t("div",Zl,[t("h5",ea,[t("b",null,[v(m(f.name)+" ",1),t("sup",ta,[t("b",null,"#"+m(f.key),1)])])]),t("div",la,[u[7]||(u[7]=v("Description: ")),t("b",null,m(f.desc),1)]),t("div",aa,[(o(!0),i(P,null,U(f.dates,(V,_)=>(o(),i("div",{key:_,style:{"font-weight":"bold"}},[t("div",oa,[t("b",null,[n(C,{icon:"calendar"}),v(" "+m(V),1)])])]))),128))]),t("div",sa,[(o(!0),i(P,null,U(f.selections,(V,_)=>(o(),i("div",{key:_,style:{"font-weight":"bold",width:"150px"}},[t("div",na,[t("b",{style:Y({color:`${V.type=="drop"?"red":"green"}`})},m(`${V.name}: (${V.timerange})`),5)])]))),128))]),t("div",ia,[t("span",ra,[u[8]||(u[8]=v("Pick: ")),t("code",ua,m(f.selectedModel),1)]),t("span",da,[u[9]||(u[9]=v("Prediction: ")),t("code",pa,m(f.selectedMethod),1)])]),t("div",va,[n($,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:V=>ve(f),style:{"margin-top":"1rem"}},{default:x(()=>[n(C,{icon:"plus"}),v(" Import "+m(f.name),1)]),_:2},1032,["onClick"]),n($,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:V=>Qe(f),style:{"margin-top":"1rem"}},{default:x(()=>[n(C,{icon:"copy"}),u[10]||(u[10]=v(" Copy Share Link "))]),_:2},1032,["onClick"]),n($,{"bt-disabled":!1,"bt-size":"small","bt-type":"button",onClick:u[4]||(u[4]=V=>b.value=!b.value),style:{"margin-top":"1rem",background:"red"}},{default:x(()=>[n(C,{icon:"trash"}),u[11]||(u[11]=v(" Delete "))]),_:1})])])]))),128))],64)):(o(),i("div",ca,[t("span",fa,[n(C,{icon:"inbox"})]),u[13]||(u[13]=t("h5",{style:{padding:"0",margin:"0"}},"No Snapshot(s) Found!",-1)),u[14]||(u[14]=t("p",{style:{padding:"0",margin:"0","text-align":"center"}},[v("To add a new Snapshot, select Normal & Drop(s) on active Leak Detection chart and click "),t("b",null,"Create Snapshot")],-1))]))])])):S("",!0)],64)}}}),$a=ft(ya,[["__scopeId","data-v-a98f17cd"]]);export{$a as default};
