import{d as Be,h as r,i as Ye,k as A,o as s,c as i,B as ft,r as je,a as p,w as T,e as l,F as S,y as P,n as V,u as v,t as g,f as w,b as Pe,l as L,p as D,x as Ee,K as ze,m as bt}from"./index-Rc2vnhCc.js";import{_ as Ve}from"./InputView.vue_vue_type_style_index_0_lang-Dxiw5GlD.js";import{_ as gt}from"./MainWrapperView.vue_vue_type_style_index_0_lang-DIJ2Y7yW.js";import{u as Ge}from"./theme-BaF0nCt8.js";import{_ as he}from"./SelectView.vue_vue_type_style_index_0_lang-BrZxz3S9.js";import{_ as B}from"./ButtonView.vue_vue_type_style_index_0_computed_true_lang-Bger9hZ6.js";import{h as ht}from"./moment-C5S46NFB.js";import{a as xt}from"./axios-BimPEqV4.js";import{_ as Ke}from"./CheckboxView.vue_vue_type_style_index_0_computed_true_lang-LvsZJm-b.js";import{a as kt}from"./spotModel-CSeGnDAl.js";import{t as wt,_ as Ue,u as St,L as Ct}from"./LoadingView-CtJVlqqG.js";import{i as We}from"./index-CehbAW_K.js";const Dt="/assets/mapview_rtu-BOpd48i8.jpg",_t=Be({__name:"HistoryECharts",props:{chartData:{type:Object,required:!0},selectedSpot:{type:String,required:!0},toleranceValue:{type:Number,required:!1,default:0},trunkLength:{type:Number,required:!0},predictionResult:{type:Object,required:!1}},emits:["onToleranceChanged"],setup(Ae,{emit:J}){const Q=J,xe=wt(),K=r(xe.getAllTrunk()),$=Ge(),_=r(null),Y=r(null),I=r([]),b=Ae,h=r(b.toleranceValue),M=r({title:{left:"center",textStyle:{fontSize:14,fontWeight:"bold",color:$.accentColorSecondary}},tooltip:{trigger:"axis",axisPointer:{type:"cross"},backgroundColor:"rgba(255, 255, 255, 0.8)",position:function(y,c,k,f,O){var j={top:10};return j[["left","right"][+(y[0]<O.viewSize[0]/2)]]=30,j.toFixed(2)},extraCssText:"width: 170px"},axisPointer:{link:{xAxisIndex:"all"},label:{backgroundColor:"#777"}},legend:{data:[],bottom:0,textStyle:{color:$.accentColor}},grid:{left:"8%",right:"0%",bottom:"22%",top:60,height:"61%"},xAxis:[{type:"value",min:0,max:0,position:"bottom",interval:.05,axisLabel:{formatter:y=>{const c=K.value[b.selectedSpot].spot;for(let k=0;k<c.length;k++)if(y===+c[k].pos)return`${c[k].name}`},rotate:45,fontSize:10,color:$.accentColorSecondary},axisTick:{show:!0,alignWithLabel:!0,lineStyle:{color:$.accentColorSecondary}},axisLine:{show:!0,lineStyle:{color:$.accentColorSecondary}},splitLine:{show:!1,lineStyle:{color:"#00000011"}},minorTick:{show:!1},minorSplitLine:{show:!1,lineStyle:{color:"#00000011"}}}],yAxis:{name:"Pressure (PSI)",nameLocation:"middle",max:K.value[b.selectedSpot].spot.maxY,nameGap:40,minorTick:{show:!0,splitNumber:5,lineStyle:{color:$.accentColorSecondary}},minorSplitLine:{show:!0,lineStyle:{color:"#00000011"}},type:"value",axisLabel:{textStyle:{color:$.accentColorSecondary}},axisLine:{lineStyle:{color:$.accentColorSecondary}},axisTick:{show:!0,lineStyle:{color:$.accentColorSecondary}},splitLine:{lineStyle:{type:"dotted"}}},series:[]}),R=async()=>{const y=await W(b.chartData);pe(y)},W=y=>new Promise((c,k)=>{try{const f=[],O=K.value[b.selectedSpot].spot;Object.keys(y).forEach(j=>{const X=y[j].data,ee=X.map((G,U)=>{const te=+O[U].pos,q=+parseFloat(G.avgPsiValues).toFixed(2);return[te,q]});if(y[j].type==="normal"){let G=[];for(let U=0;U<X.length;U++){const te=+O[U].pos,q=+parseFloat(X[U].avgPsiValues).toFixed(2),m=h.value/100*q,le=+(q-m).toFixed(2);G.push([te,le])}f.push(ee),f.push(G)}else f.push(ee)}),c(f)}catch(f){k(f)}}),pe=y=>{I.value=[];const c=y.map((k,f)=>f===0?{name:"Normal",type:"line",xAxisIndex:0,data:k,smooth:!0,itemStyle:{color:$.accentColor}}:f===1?{name:"Drop Tolerance",type:"line",xAxisIndex:0,data:k,smooth:!0,itemStyle:{color:"red"},lineStyle:{width:1,type:"dashed"}}:{name:"Actual Drop "+(f-1),type:"line",xAxisIndex:0,data:k,smooth:!0});if(M.value.legend.data=c.map(k=>k.name),M.value.xAxis[0].min=0,M.value.xAxis[0].max=b.trunkLength,M.value.xAxis[1]={type:"value",min:0,max:b.trunkLength,name:"Pipeline (KM)",nameLocation:"middle",interval:2,nameGap:30,nameTextStyle:{color:$.accentColorSecondary,fontSize:12},position:"top",axisLabel:{formatter:"{value}",textStyle:{color:$.accentColorSecondary}}},b.predictionResult)for(let k=0;k<b.predictionResult.length;k++){const f=parseFloat(b.predictionResult[k].suspectLocation.leakData.leak_point);c.push({name:"Leakage",type:"line",xAxisIndex:1,data:[],markLine:{symbol:"diamond",lineStyle:{type:"dashed",color:"red"},label:{show:!0,formatter:`>> ${f} KM`,position:"insideEndTop"},data:[{xAxis:f}]}}),I.value.push(f)}M.value.series=c,Y.value&&(Y.value.setOption(M.value),console.log(Y.value.getOption().series))};return Ye(()=>{Y.value=We(_.value),h.value=0,R().catch(y=>{console.error(y)})}),setTimeout(()=>{h.value=2.5,Q("onToleranceChanged",h.value)},3e3),A(()=>b.chartData,async()=>{await R()}),A(()=>h.value,async()=>{await R()}),A(()=>b.toleranceValue,()=>{h.value=b.toleranceValue}),A(()=>b.predictionResult,async()=>{await R()}),(y,c)=>(s(),i("div",{ref_key:"chart",ref:_,style:{width:"100%",height:"500px"}},null,512))}}),Lt={class:"col-md-3"},Tt=["value"],$t={style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},Pt={style:{display:"flex","flex-flow":"row nowrap",gap:"1rem","align-items":"center"}},Vt={class:"col-md-12",style:{"padding-bottom":"6rem"}},At={class:"table-responsive"},Mt={style:{display:"flex","flex-flow":"row nowrap","justify-content":"flex-end",gap:"1rem"}},Ft={style:{display:"flex","flex-flow":"row wrap","justify-content":"flex-end","align-items":"center",gap:"0.5rem","margin-bottom":"1rem",border:"1px solid #ccc",width:"fit-content",padding:"10px","border-radius":"100px"}},Rt={style:{display:"flex","flex-flow":"row nowrap","align-items":"center"}},Ot={style:{display:"flex","flex-flow":"row nowrap","align-items":"center"}},Nt={class:"tbl"},It={class:"theads"},jt={style:{display:"flex","flex-flow":"column",width:"150px"}},Et={style:{"font-size":"14px","font-weight":"bold"}},zt={key:1,style:{color:"#ccc"}},Kt={style:{display:"flex","flex-flow":"row nowrap"}},Ut={style:{width:"100%",display:"flex","flex-flow":"column"}},Bt=["src"],Yt={class:"col-md-12",style:{"margin-bottom":"1rem","margin-top":"2rem"}},Gt={class:"table-responsive"},Wt={style:{"margin-top":"1rem"}},qt={class:"tbl2"},Ht=["onClick"],Zt={style:{"margin-top":"1rem"}},Jt={class:"tbl2"},Qt={key:1,class:"leak-window"},Xt={class:"table-responsive"},el={style:{width:"100%","margin-top":"1rem"},class:"table table-striped table-hover;"},tl={key:0,style:{border:"1px solid #ccc",padding:"10px"}},ll={key:1,style:{border:"1px solid #ccc",padding:"10px"}},al={style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},ol={key:0,style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},nl={key:1,style:{"font-weight":"bold",border:"1px solid #ccc",padding:"10px"}},sl={key:0},il=["href"],rl={style:{"margin-top":"1rem"}},ul={key:1},cl={style:{"margin-top":"1rem"}},dl={key:2,class:"playback-controller"},pl={style:{display:"flex","flex-flow":"row nowrap",gap:"0.5rem"}},vl={style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},yl={style:{cursor:"pointer",padding:"10px",border:"1px solid #ccc","margin-bottom":"1rem","border-radius":"10px"}},ml={style:{"border-radius":"10px",display:"flex","flex-flow":"row nowrap","justify-content":"space-between","padding-left":"10px","padding-right":"10px",border:"1px solid #ccc",padding:"20px","margin-bottom":"1rem"}},fl={style:{border:"1px solid #ccc",padding:"10px","padding-left":"40px","padding-right":"40px","border-radius":"100px"}},bl={style:{display:"flex","flex-flow":"row nowrap",width:"100%","align-items":"center"}},gl={style:{display:"flex","flex-flow":"no wrap",padding:"10px",gap:"0.5rem"}},hl={style:{width:"100%",padding:"10px",position:"relative"}},xl=["max","value"],kl={class:"slider-highlight"},wl={key:4,class:"pb-prompt"},Sl={class:"pbp-inner"},Ol=Be({__name:"HistorySplittedFol",setup(Ae){const J=r(),Q=r(),xe=St(),K=r("randfor"),$=kt(),_=r("trunk1"),Y=r(!0),I=r([]),b=r([]),h=r(0),M=r(0),R=r(0),W=r(500),pe=r(""),y=r({trunk1:{name:"RANTAU TRUNKLINE",spots:[]}});Ye(async()=>{X(),await $.getSpotsWithTresholds().then(async a=>{Object.keys(a).forEach(e=>{y.value.trunk1.spots.push(a[e])}),y.value.trunk1.trunkLength=63.3,setTimeout(async()=>{await oe()},500)})});const c=Ge(),k=r(60),f=r(),O=r([]),j=r(!1);c.asideToggle(!1);const X=()=>{const a=new Date,e=a.getFullYear(),n=String(a.getMonth()+1).padStart(2,"0"),o=String(a.getDate()).padStart(2,"0"),t=`${e}-${n}-${o}`;f.value=t};A(()=>[f.value,k.value,_.value],async()=>{Y.value||await oe()});const ee=async a=>new Promise(async(e,n)=>{try{const o=y.value[_.value];let t=[];for(let x=0;x<o.spots.length;x++)t.push(o.spots[x].id);const u={datefilter:a,timeFilter:k.value,idFilter:t},d=await xt.post(bt.baseEnd+"api/History/getsplittedhistdata",u);Y.value=!1,e(d.data)}catch(o){n(o)}}),G=r({});function U(a){const e={};return a.forEach(n=>{n.data.forEach(o=>{const{idSpot:t,avgPsiValues:u}=o;e[t]?(u>e[t].maxValue&&(e[t].maxValue=u),u<e[t].minValue&&(e[t].minValue=u)):e[t]={maxValue:u,minValue:u}})}),G.value=e,G.value}const te=ft(()=>U(O.value));function q(a,e){const n=te.value;if(!n[e])return"";const o=a.data.find(t=>t.idSpot===e);if(o){if(o.avgPsiValues===n[e].maxValue)return"highest-value";if(o.avgPsiValues===n[e].minValue)return"lowest-value"}return""}const m=r({});let le=null;const N=r(null),ke=r({});A(()=>m.value,()=>{if(le=Object.keys(m.value),ae(),N.value!=null){ke.value=[];const a=N.value,e=m.value[a].data;le.filter(o=>o!==a).forEach(o=>{const t=m.value[o].data,u=[];y.value[_.value].spots.forEach((d,x)=>{const F=d.id,Z=e.find(de=>de.idSpot===F),Ie=t.find(de=>de.idSpot===F);if(Z&&Ie){const de=Z.avgPsiValues.toFixed(2)-Ie.avgPsiValues.toFixed(2);u[x]=de}else u[x]=0}),ke.value.push({dropKey:o,deltas:u})})}});const Me=(a,e,n)=>{const o=e.timeRange,t=e.type,u=e.rangeData,d=e.dateFilter;a?(m.value[o+"."+t+"."+d]={timerange:o,type:t,checkbox:n,data:u,date:d},t==="normal"&&(N.value=o+"."+t+"."+d),m.value=Fe(m.value),ae()):(delete m.value[o+"."+t+"."+d],t==="normal"&&N.value===o+"."+t+"."+d&&(N.value=null),m.value=Fe(m.value),Qe(!0))},Fe=a=>{const e=Object.entries(a);return e.sort((o,t)=>o[1].type==="normal"&&t[1].type!=="normal"?-1:o[1].type!=="normal"&&t[1].type==="normal"?1:0),Object.fromEntries(e)},qe=a=>a.type==="normal"?N.value!==null&&N.value!==a.timeRange+"."+a.type+"."+a.date:!1,ae=()=>{Object.keys(m.value).length>1?j.value=!0:j.value=!1},He=async()=>{O.value=[],we(),ae(),await oe().then(()=>{}).catch(a=>{console.log(a)})},oe=async()=>{we(),O.value=[];try{let e=[...await ee(f.value)];if(I.value.length>0)for(let n=0;n<I.value.length;n++){const o=I.value[n];if(o!==null){if(o.value!==f.value){const t=await ee(o.value);e=e.concat(t)}}else console.log("Null")}O.value=e,b.value=e}catch(a){console.log(a)}},Ze=()=>{we(),ae()},we=()=>{Object.keys(m.value).forEach(a=>{const e=m.value[a].checkbox;e.checked=!1}),N.value=null,m.value={},ae()},ve=r(),Je=async(a,e)=>{const n=a.map((d,x)=>{const F=d.length>1?d.map(Z=>Number(Z)||0):[0];return x==0?{name:"Normal",type:"line",data:F,smooth:!0}:{name:"Drop "+x,type:"line",data:F,smooth:!0}});let o=[];for(let d=0;d<y[_.value].spots.length;d++)o.push(y[_.value].spots[d].name);const t=await Promise.all(n);t.sort((d,x)=>d.name==="Normal"?-1:x.name==="Normal"?1:0);const u={toolbox:{show:!0,orient:"vertical",feature:{dataZoom:{yAxisIndex:"none"},dataView:{readOnly:!1},magicType:{type:["line","bar"]},restore:{},saveAsImage:{}}},tooltip:{trigger:"item",axisPointer:{type:"cross"}},grid:{left:"10%",right:"10%",bottom:"10%",containLabel:!0},legend:{show:!0},xAxis:{type:"category",data:o,axisLabel:{show:!0,rotate:45},boundaryGap:!1,axisTick:{alignWithLabel:!0}},yAxis:{name:"Pressure (PSI)",nameTextStyle:{verticalAlign:"middle"},axisTick:{show:!0,inside:!0},type:"value",axisLine:{show:!0}},series:t};if(!e)ve.value.setOption(u);else{let d={toolbox:{show:!0,orient:"vertical",feature:{dataZoom:{yAxisIndex:"none"},dataView:{readOnly:!1},magicType:{type:["line","bar"]},restore:{},saveAsImage:{}}},tooltip:{trigger:"item",axisPointer:{type:"cross"}},grid:{left:"10%",right:"10%",bottom:"10%",containLabel:!0},legend:{show:!0},xAxis:{type:"category",data:o,axisLabel:{show:!0,rotate:45},boundaryGap:!1,axisTick:{alignWithLabel:!0}},yAxis:{name:"Pressure (PSI)",nameTextStyle:{verticalAlign:"middle"},axisTick:{show:!0,inside:!0},type:"value",axisLine:{show:!0}},series:t};ve.value.clear(),ve.value.setOption(d)}},Qe=(a=!1)=>{if(ve.value){let e=[];Object.keys(m.value).forEach(n=>{const o=m.value[n].data;let t=[];for(let u=0;u<o.length;u++)t.push(parseFloat(o[u].avgPsiValues).toFixed(2));e.push(t)}),Je(e,a)}},Re=(a,e)=>{const o=m.value[a].data;for(let t=0;t<o.length;t++)if(o[t].idSpot==e)return o[t].avgPsiValues.toFixed(2)},ne=a=>a.spots,Xe=(a,e)=>{const n=m.value[e],o=n.timerange,t=n.type,u=n.date;t==="normal"&&N.value===o+"."+t+"."+u&&(N.value=null),a.checked=!1;const d={...m.value};delete d[e],m.value=d},se=r(0),et=()=>{se.value++,I.value.push(null)},tt=async()=>{se.value>0&&(se.value--,I.value.pop()),await oe()},lt=async(a,e)=>{I.value[e]=a,await oe()};r(0);const ie=r(!1),Se=r([]),E=r([]),H=r(!1),ye=r(),at=r(),ot=async()=>{Se.value=[],console.log(m.value);const a=xe.predict(m.value,K.value);if(ie.value=!0,K.value==="randfor"?setTimeout(()=>{E.value=a},4e3):E.value=a,E.value!=null)for(let e=0;e<E.value.length;e++)E.value[e].suspectLocation.leak&&Se.value.push(E.value[e])},Oe=r(),Ne=r(),nt=(a,e,n)=>{ye.value=a,H.value=!1,H.value=!0,Oe.value=e,Ne.value=n};A(()=>ie.value,()=>{ie.value||(H.value=!1,E.value=null,ye.value=null,at.value=null)}),A(()=>J.value,()=>{st(),ue(h.value)});const st=()=>{Q.value=We(J.value);const a={grid:{top:"10%",left:"10%",right:"10%",bottom:"15%"},legend:{show:!0,type:"scroll",orient:"horizontal"},xAxis:{type:"category",data:[],boundaryGap:!1,axisLabel:{rotate:45,labelStyle:{fontSize:10}},splitLine:{show:!0,lineStyle:{type:"dashed"}},axisTick:{alignWithLabel:!0}},yAxis:{type:"value",name:"Pressure (PSI)",nameGap:10,max:600,axisTick:{show:!0,inside:!0}},series:[]};Q.value.setOption(a)};let Ce=[];const me={},De=r([]),re=r({}),it=r(),ue=a=>{Ce=[];for(let o of y.value[_.value].spots)me[o.name]=[];b.value.slice(0,a+1).forEach((o,t)=>{const u=`${o.dateFilter} (${o.timeRange})`;Ce.push(u),it.value=u,o.data.forEach(d=>{const x=y.value[_.value].spots.find(Z=>Z.id===d.idSpot).name,F=d.avgPsiValues??0;me[x][t]=Number(F.toFixed(2))})});const n=Object.keys(me).map(o=>({name:o,type:"line",data:me[o],symbol:"none",smooth:!1,tooltip:{trigger:"axis",formatter:function(t){return t[0].value}},endLabel:{show:!0,formatter:function(t){return t.value},color:"#000",backgroundColor:"inherit",padding:5,borderRadius:5}}));Q.value.setOption({xAxis:{data:Ce},series:n})},ce=r(!1),C=r(!1),rt=a=>{C.value=!1,De.value=[],h.value=parseInt(a.target.value,10),ue(h.value),R.value=h.value/b.value.length*100};let z=null;A(()=>[C.value,W.value],()=>{C.value?(z!=null&&clearInterval(z),z=setInterval(()=>{h.value<b.value.length?(h.value++,b.value[h.value]!=null&&(ue(h.value),R.value=h.value/b.value.length*100)):(C.value=!1,clearInterval(z))},W.value)):z&&(clearInterval(z),z=null)});const ut=()=>{ce.value=!1,C.value=!1,h.value=0,De.value=[],clearInterval(z),ue(h.value),R.value=h.value/b.value.length*100},fe=()=>{C.value=!1,h.value=0,De.value=[],clearInterval(z),ue(h.value),R.value=h.value/b.value.length*100},_e=r(!1);A(()=>re.value,()=>{C.value=!1,_e.value=!0},{deep:!0});const ct=()=>{_e.value=!1,C.value=!0},dt=()=>y.value[_.value].trunkLength,Le=r(""),Te=r(""),$e=r(!0),be=r(!1);A(()=>f.value,()=>{const a=ht(f.value),e=a.add(1,"days").format("YYYY-MM-DD"),n=a.subtract(2,"days").format("YYYY-MM-DD");Le.value=e,Te.value=n});const pt=()=>{f.value=Le.value,fe(),be.value&&(C.value=!0)},vt=()=>{f.value=Te.value,fe(),be.value&&(C.value=!0)};A(()=>C.value,()=>{!C.value&&h.value==b.value.length&&$e.value&&(fe(),C.value=!0)});const yt=a=>{M.value=a},ge=a=>{const e=Math.floor(a),n=Math.abs(a-e)*60,o=Math.floor(n),t=(n-o)*60;return`${e}° ${o}' ${t.toFixed(2)}"`},mt=async a=>{pe.value=a,await navigator.clipboard.writeText(pe.value),c.notifyShow("Coordinate copied to clipboard")};return(a,e)=>{const n=je("font-awesome-icon"),o=je("center");return s(),i(S,null,[p(gt,{"context-title":"FOL | Splitted History Data"},{default:T(()=>[l("div",Lt,[p(he,{"in-label":"Select Line","model-value":_.value,"onUpdate:modelValue":e[0]||(e[0]=t=>_.value=t)},{default:T(()=>[(s(!0),i(S,null,P(Object.keys(y.value),(t,u)=>(s(),i("option",{key:u,value:t},g(y.value[t].name),9,Tt))),128))]),_:1},8,["model-value"]),p(he,{"in-label":"Time Range","model-value":k.value,"onUpdate:modelValue":e[1]||(e[1]=t=>k.value=t)},{default:T(()=>e[12]||(e[12]=[l("option",{value:"1"},"1 Menit",-1),l("option",{value:"2"},"2 Menit",-1),l("option",{value:"3"},"3 Menit",-1),l("option",{value:"4"},"4 Menit",-1),l("option",{value:"5"},"5 Menit",-1),l("option",{value:"10"},"10 Menit",-1),l("option",{value:"15"},"15 Menit",-1),l("option",{value:"30"},"30 Menit",-1),l("option",{value:"60"},"60 Menit",-1)])),_:1},8,["model-value"]),l("div",$t,[p(Ve,{"in-type":"date","in-label":"Date Filter","model-value":f.value,"onUpdate:modelValue":e[2]||(e[2]=t=>f.value=t),style:{width:"100%"}},null,8,["model-value"])]),l("div",Pt,[p(B,{onClick:tt,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:T(()=>[p(n,{icon:"minus"})]),_:1}),l("span",{class:V([`${v(c).textTheme}`])},g(se.value),3),p(B,{onClick:et,"bt-size":"small","bt-type":"button","bt-disabled":!1},{default:T(()=>[p(n,{icon:"plus"})]),_:1})]),(s(!0),i(S,null,P(se.value,(t,u)=>(s(),i("div",{key:u,style:{display:"flex","flex-flow":"row nowrap","align-items":"center",gap:"1rem"}},[p(Ve,{"in-type":"date","in-label":`Date Filter ${t}`,onOnValueChange:d=>lt(d,u),style:{width:"100%"}},null,8,["in-label","onOnValueChange"])]))),128))]),l("div",Vt,[l("div",At,[l("div",Mt,[l("div",Ft,[l("div",Rt,[e[13]||(e[13]=l("div",{style:{"background-color":"green",width:"20px",height:"20px","border-radius":"100px"}},null,-1)),l("span",{class:V([`${v(c).textTheme}`]),style:{"margin-left":"0.2rem","font-size":"12px","font-weight":"bold"}},"Nilai Tertinggi",2)]),l("div",Ot,[e[14]||(e[14]=l("div",{style:{"background-color":"red",width:"20px",height:"20px","border-radius":"100px"}},null,-1)),l("span",{class:V([`${v(c).textTheme}`]),style:{"margin-left":"0.2rem","font-size":"12px","font-weight":"bold"}},"Nilai Terendah",2)])]),p(B,{onClick:He,"bt-disabled":!1,"bt-type":"button","bt-size":"small",style:{height:"42px",width:"42px","border-radius":"100px",display:"flex","flex-flow":"row nowrap","align-items":"center"}},{default:T(()=>[p(n,{icon:"refresh"})]),_:1})]),l("table",Nt,[l("thead",It,[l("tr",{style:{padding:"20px"},class:V([`${v(c).textTheme}`])},[l("th",{style:w({border:`1px solid ${v(c).accentColor}`})},[p(n,{icon:"check-double"})],4),l("th",{style:w({border:`1px solid ${v(c).accentColor}`})},"Interval",4),(s(!0),i(S,null,P(ne(y.value[_.value]),(t,u)=>(s(),i("th",{style:w({border:`1px solid ${v(c).accentColor}`}),key:u},g(t.name),5))),128))],2)]),l("tbody",null,[(s(!0),i(S,null,P(O.value,(t,u)=>(s(),i("tr",{key:u},[l("td",{style:w({border:`1px solid ${v(c).accentColor}`,width:"150px"}),class:V([`${v(c).textTheme}`])},[l("div",jt,[p(Ke,{cb_disabled:qe({timeRange:t.timeRange,type:"normal"}),cb_data:{timeRange:t.timeRange,type:"normal",rangeData:t.data,dateFilter:t.dateFilter},onOnCheckBoxChange:Me,cb_label:"Normal"},null,8,["cb_disabled","cb_data"]),p(Ke,{cb_disabled:!1,cb_checked:!1,cb_data:{timeRange:t.timeRange,type:"drop",rangeData:t.data,dateFilter:t.dateFilter},onOnCheckBoxChange:Me,cb_label:"Drop"},null,8,["cb_data"])])],6),l("td",{style:w({border:`1px solid ${v(c).accentColor}`}),class:V([`${v(c).textTheme}`])},[l("span",Et,g(t.dateFilter),1),e[15]||(e[15]=l("br",null,null,-1)),D(g(t.timeRange),1)],6),(s(!0),i(S,null,P(ne(y.value[_.value]),(d,x)=>(s(),i("td",{style:w({border:`1px solid ${v(c).accentColor}`,position:"relative"}),key:x,class:V([`${q(t,d.id)}`,`${v(c).textTheme}`])},[t.data.find(F=>F.idSpot===d.id)?(s(),i(S,{key:0},[D(g(t.data.find(F=>F.idSpot===d.id).avgPsiValues.toFixed(2)),1)],64)):(s(),i("span",zt,"N/A"))],6))),128))]))),128))])])])])]),_:1}),j.value?(s(),i("div",{key:0,class:V(["chart-container",[`${v(c).mTheme}`]])},[l("button",{onClick:Ze,class:"chc-dismiss",style:w({color:`${v(c).accentColor}`})},[p(n,{icon:"close"})],4),l("div",Kt,[l("div",Ut,[p(o,null,{default:T(()=>[p(Ve,{"in-label":"Drop Tolerance Value","in-type":"number","model-value":M.value,"onUpdate:modelValue":e[3]||(e[3]=t=>M.value=t),style:{width:"200px"}},null,8,["model-value"])]),_:1}),Object.keys(m.value).length?(s(),Pe(_t,{key:0,onOnToleranceChanged:yt,"chart-data":m.value,"selected-spot":_.value,"trunk-length":dt(),"tolerance-value":M.value,"prediction-result":Se.value},null,8,["chart-data","selected-spot","trunk-length","tolerance-value","prediction-result"])):L("",!0)])]),l("img",{src:v(Dt),alt:"map",style:{width:"100%",height:"600px","border-radius":"10px","object-fit":"contain"}},null,8,Bt),l("div",Yt,[p(o,null,{default:T(()=>[p(he,{"in-label":"Prediction Method","model-value":K.value,"onUpdate:modelValue":e[4]||(e[4]=t=>K.value=t)},{default:T(()=>e[16]||(e[16]=[l("option",{value:"randfor"},"MeLan",-1),l("option",{value:"dynamic"},"Dynamic",-1),l("option",{value:"static"},"Static",-1)])),_:1},8,["model-value"]),Object.keys(m.value).length>1?(s(),Pe(B,{key:0,"bt-type":"button","bt-disabled":!1,onClick:ot},{default:T(()=>[p(n,{icon:"water"}),e[17]||(e[17]=D(" Estimate Leak Location "))]),_:1})):L("",!0)]),_:1})]),l("div",Gt,[l("h5",Wt,[l("b",null,[p(n,{icon:"oil-well"}),e[18]||(e[18]=D(" Selected Pressures"))])]),l("table",qt,[l("thead",null,[l("tr",{style:{padding:"5px"},class:V([`${v(c).textTheme}`])},[l("th",{style:w({border:`1px solid ${v(c).accentColor}`})},"ACTION",4),l("th",{style:w({border:`1px solid ${v(c).accentColor}`})},"PINNED SERIES",4),(s(!0),i(S,null,P(ne(y.value[_.value]),(t,u)=>(s(),i("th",{style:w({border:`1px solid ${v(c).accentColor}`}),key:u},g(t.name),5))),128))],2)]),l("tbody",null,[(s(!0),i(S,null,P(v(le),(t,u)=>(s(),i("tr",{key:u},[l("td",{style:w({border:`1px solid ${v(c).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},[l("button",{onClick:d=>Xe(m.value[t].checkbox,t),class:"remove-series",type:"button"},[p(n,{icon:"close"})],8,Ht)],4),l("td",{class:V([`${v(c).textTheme}`]),style:w({border:`1px solid ${v(c).accentColor}`,position:"relative",textTransform:"uppercase",fontWeight:"bold"})},[D(g(m.value[t].date),1),e[19]||(e[19]=l("br",null,null,-1)),D(" "+g(m.value[t].timerange),1),e[20]||(e[20]=l("br",null,null,-1)),D(" "+g(m.value[t].type),1)],6),(s(!0),i(S,null,P(ne(y.value[_.value]),(d,x)=>(s(),i("td",{style:w({border:`1px solid ${v(c).accentColor}`}),class:V([`${v(c).textTheme}`]),key:x},[Re(t,d.id)?(s(),i(S,{key:0},[D(g(Re(t,d.id)),1)],64)):(s(),i(S,{key:1},[D("0.00")],64))],6))),128))]))),128))])]),l("h5",Zt,[l("b",null,[p(n,{icon:"turn-down"}),e[21]||(e[21]=D(" Delta"))])]),l("table",Jt,[l("thead",null,[l("tr",{style:{padding:"5px"},class:V([`${v(c).textTheme}`])},[l("th",{style:w({border:`1px solid ${v(c).accentColor}`})},"DROPS",4),l("th",{style:w({border:`1px solid ${v(c).accentColor}`})},"PINNED SERIES",4),(s(!0),i(S,null,P(ne(y.value[_.value]),(t,u)=>(s(),i("th",{style:w({border:`1px solid ${v(c).accentColor}`}),key:u},g(t.name),5))),128))],2)]),l("tbody",null,[(s(!0),i(S,null,P(ke.value,(t,u)=>(s(),i("tr",{key:u},[l("td",{style:w({border:`1px solid ${v(c).accentColor}`})},g(u+1),5),l("td",{style:w({border:`1px solid ${v(c).accentColor}`})},g(t.dropKey.split(".")[0]+"."+t.dropKey.split(".")[1]+"."+t.dropKey.split(".")[2]),5),(s(!0),i(S,null,P(t.deltas,(d,x)=>(s(),i("td",{key:x,style:w({border:`1px solid ${v(c).accentColor}`})},g(d.toFixed(2)),5))),128))]))),128))])])])],2)):L("",!0),ie.value?(s(),i("div",Qt,[l("div",{class:V(["leak-body",[`${v(c).mTheme}`]])},[l("button",{type:"button",onClick:e[5]||(e[5]=t=>ie.value=!1),class:"leak-dismiss"},[p(n,{icon:"times"})]),l("div",{class:"l-left",style:w({width:H.value?"40%":"100%"})},[e[34]||(e[34]=l("h4",{style:{"font-weight":"bold"}},"Leak Analysis",-1)),e[35]||(e[35]=l("hr",null,null,-1)),E.value?(s(!0),i(S,{key:0},P(E.value,(t,u)=>(s(),i("div",{class:"analysis-set",key:u},[t!=!1?(s(),i(S,{key:0},[l("h6",null,[l("b",null,"Analysis on Dataset "+g(u+1),1)]),l("p",null,[e[32]||(e[32]=D(" Result: ")),t!=!1&&t.suspectLocation.leak?(s(),i(S,{key:0},[e[30]||(e[30]=l("b",{style:{color:"red"}},"Possible leak detected!",-1)),l("div",Xt,[l("table",el,[l("tr",null,[e[22]||(e[22]=l("th",{style:{border:"1px solid #ccc",padding:"10px"}},"Estimated Leak Point",-1)),t.suspectLocation.leakData.pu_location?(s(),i("th",tl," PU ")):L("",!0),t.suspectLocation.leakData.coordinate?(s(),i("th",ll," Coordinate ")):L("",!0)]),l("tbody",null,[l("tr",null,[l("td",al,g(t.suspectLocation.leakData.leak_point)+" KM ",1),t.suspectLocation.leakData.pu_location?(s(),i("td",ol," KM "+g(t.suspectLocation.leakData.pu_location),1)):L("",!0),t.suspectLocation.leakData.coordinate?(s(),i("td",nl,[e[24]||(e[24]=D(" LatLng: ")),l("code",null,g(t.suspectLocation.leakData.coordinate.latitude+", "+t.suspectLocation.leakData.coordinate.longitude),1),e[25]||(e[25]=l("br",null,null,-1)),e[26]||(e[26]=D(" DMS: ")),l("code",null,g(`${ge(t.suspectLocation.leakData.coordinate.latitude)}, ${ge(t.suspectLocation.leakData.coordinate.longitude)}`),1),e[27]||(e[27]=l("br",null,null,-1)),p(B,{onClick:d=>mt(`LATLNG: ${t.suspectLocation.leakData.coordinate.latitude}, ${t.suspectLocation.leakData.coordinate.longitude}
DMS: ${ge(t.suspectLocation.leakData.coordinate.latitude)}, ${ge(t.suspectLocation.leakData.coordinate.longitude)}`),style:{"margin-top":"5px"},"bt-disabled":!1,"bt-size":"small"},{default:T(()=>[p(n,{icon:"copy"}),e[23]||(e[23]=D(" Copy Coord "))]),_:2},1032,["onClick"])])):L("",!0)])])])]),t.suspectLocation.leakData.coordinate?L("",!0):(s(),i("p",sl,[p(n,{icon:"info-circle"}),e[28]||(e[28]=D(" Map view and PU Location data is currently not supported for this line "))])),p(B,{onClick:d=>nt(t.suspectLocation.leakData.coordinate,t.suspectLocation.leakData.leak_point,t.suspectLocation.leakData.pu_location),"bt-disabled":!t.suspectLocation.leakData.coordinate},{default:T(()=>[p(n,{icon:"map-marker"}),e[29]||(e[29]=D(" Pinpoint on Map"))]),_:2},1032,["onClick","bt-disabled"]),t.suspectLocation.leakData.coordinate?(s(),i("a",{key:1,class:"gmaps",target:"_blank",href:`https://www.google.com/maps?q=${t.suspectLocation.leakData.coordinate.latitude},${t.suspectLocation.leakData.coordinate.longitude}`,style:{"margin-left":"0.5rem"}},"Google Maps",8,il)):L("",!0)],64)):(s(),i(S,{key:1},[e[31]||(e[31]=l("b",{style:{color:"#555"}},"No leak detected",-1)),l("ol",rl,[(s(!0),i(S,null,P(t.suspectLocation.probabilities,(d,x)=>(s(),i("li",{key:x},g(d),1))),128))])],64))])],64)):(s(),i("h6",ul,[l("b",null,"Analysis on Dataset "+g(u+1),1),e[33]||(e[33]=l("b",{style:{color:"#555"}},"Tidak ada indikasi",-1)),l("ol",cl,[(s(!0),i(S,null,P(t.suspectLocation.probabilities,(d,x)=>(s(),i("li",{key:x},g(d),1))),128))])]))]))),128)):(s(),Pe(Ct,{key:1,message:"Calculating leak probabilities..."}))],4),H.value?(s(),i("div",{key:0,class:"l-right",style:w({width:H.value?"60%":"100%",position:"relative"})},[e[36]||(e[36]=l("h4",{style:{"font-weight":"bold"}},"Map View",-1)),e[37]||(e[37]=l("hr",null,null,-1)),p(Ue,{latitude:ye.value.latitude,longitude:ye.value.longitude,"leak-point":Oe.value,"pu-location":Ne.value},null,8,["latitude","longitude","leak-point","pu-location"])],4)):L("",!0)],2)])):L("",!0),ce.value?(s(),i("div",dl,[l("button",{type:"button",onClick:ut,class:"leak-dismiss"},[p(n,{icon:"close"})]),e[41]||(e[41]=l("h5",{style:{"text-align":"center"}},[l("b",null,"History Data Playback")],-1)),p(o,null,{default:T(()=>[p(he,{style:{width:"400px"},"in-label":"Speed","model-value":W.value,"onUpdate:modelValue":e[6]||(e[6]=t=>W.value=t)},{default:T(()=>e[38]||(e[38]=[l("option",{value:"1000"},"Slowest",-1),l("option",{value:"500"},"Slower",-1),l("option",{value:"300"},"Moderate",-1),l("option",{value:"250"},"Faster",-1),l("option",{value:"200"},"Fastest",-1)])),_:1},8,["model-value"])]),_:1}),l("div",pl,[l("label",vl,[Ee(l("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>$e.value=t),type:"checkbox"},null,512),[[ze,$e.value]]),e[39]||(e[39]=D(" Auto-replay "))]),l("label",yl,[Ee(l("input",{"onUpdate:modelValue":e[8]||(e[8]=t=>be.value=t),type:"checkbox"},null,512),[[ze,be.value]]),e[40]||(e[40]=D(" Autoplay on navigating "))])]),l("div",ml,[p(B,{"bt-disabled":!1,onClick:vt},{default:T(()=>[p(n,{icon:"backward"}),D("    "+g(Te.value),1)]),_:1}),l("span",fl,[l("b",null,g(f.value),1)]),p(B,{"bt-disabled":!1,onClick:pt},{default:T(()=>[D(g(Le.value)+"    ",1),p(n,{icon:"forward"})]),_:1})]),l("div",{ref_key:"heatMap",ref:J,style:{width:"100%",height:"600px"}},null,512),l("div",bl,[l("div",gl,[C.value?L("",!0):(s(),i("button",{key:0,onClick:e[9]||(e[9]=t=>C.value=!C.value),class:"controlbtn",type:"button"},[p(n,{icon:"play"})])),C.value?(s(),i("button",{key:1,onClick:e[10]||(e[10]=t=>C.value=!C.value),class:"controlbtn",type:"button"},[p(n,{icon:"pause"})])):L("",!0)]),l("div",hl,[l("input",{onChange:rt,type:"range",min:0,max:b.value.length,value:h.value,class:"slider"},null,40,xl),l("span",kl,[l("span",{class:"slider-track",style:w({width:`${R.value}%`})},null,4)])]),l("div",null,[!C.value&&h.value==b.value.length?(s(),i("button",{key:0,onClick:fe,class:"controlbtn",type:"button"},[p(n,{icon:"undo"})])):L("",!0)])])])):L("",!0),ce.value?L("",!0):(s(),i("button",{key:3,type:"button",class:"showplayback",onClick:e[11]||(e[11]=t=>ce.value=!ce.value)},[p(n,{icon:"play"})])),_e.value?(s(),i("div",wl,[l("div",Sl,[l("button",{type:"button",onClick:ct,class:"pbp-dismiss"},[p(n,{icon:"close"})]),e[42]||(e[42]=l("h3",null,[l("b",null,"Possible Leak Detected")],-1)),p(Ue,{"leak-point":re.value.suspectLocation.leakData.leak_point,latitude:re.value.mapsLink.latitude,longitude:re.value.mapsLink.longitude,"pu-location":re.value.suspectLocation.leakData.pu_location},null,8,["leak-point","latitude","longitude","pu-location"])])])):L("",!0)],64)}}});export{Ol as default};
